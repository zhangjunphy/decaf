<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (C) 2018-2024 Jun Zhang &lt;zhangjunphy[at]gmail[dot]com&gt;</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- This file is a part of decafc.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- decafc is free software: you can redistribute it and/or modify it under the</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- terms of the MIT (X11) License as described in the LICENSE file.</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- decafc is distributed in the hope that it will be useful, but WITHOUT ANY</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- FOR A PARTICULAR PURPOSE.  See the X11 license for more details.</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Parser.Helper</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Lexer.html"><span class="hs-identifier">Lexer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Lex.html#Alex"><span class="hs-identifier">Alex</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lexer.Token.html#Token"><span class="hs-identifier">Token</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lexer.Lex.html#alexMonadScan"><span class="hs-identifier">alexMonadScan</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lexer.Lex.html#alexError"><span class="hs-identifier">alexError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Lexer.Lex.html#addError"><span class="hs-identifier">addError</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.SourceLoc.html"><span class="hs-identifier">Util.SourceLoc</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.Printf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">printf</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Types.html"><span class="hs-identifier">Types</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier">CompileError</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier">CompileError</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Formatting</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">sformat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">shown</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%)</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="annot"><a href="Parser.Helper.html#getID"><span class="hs-identifier hs-type">getID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lexer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-22"></span><span id="getID"><span class="annot"><span class="annottext">getID :: Token -&gt; Text
</span><a href="Parser.Helper.html#getID"><span class="hs-identifier hs-var hs-var">getID</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#Identifier"><span class="hs-identifier hs-type">Identifier</span></a></span><span> </span><span id="local-6989586621679206481"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206481"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206481"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="annot"><a href="Parser.Helper.html#getLiteral"><span class="hs-identifier hs-type">getLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lexer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-25"></span><span id="getLiteral"><span class="annot"><span class="annottext">getLiteral :: Token -&gt; Text
</span><a href="Parser.Helper.html#getLiteral"><span class="hs-identifier hs-var hs-var">getLiteral</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#IntLiteral"><span class="hs-identifier hs-type">IntLiteral</span></a></span><span> </span><span id="local-6989586621679206484"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206484"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206484"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-26"></span><span class="annot"><a href="Parser.Helper.html#getLiteral"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#BooleanLiteral"><span class="hs-identifier hs-type">BooleanLiteral</span></a></span><span> </span><span id="local-6989586621679206486"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206486"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206486"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-27"></span><span class="annot"><a href="Parser.Helper.html#getLiteral"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#CharLiteral"><span class="hs-identifier hs-type">CharLiteral</span></a></span><span> </span><span id="local-6989586621679206488"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206488"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206488"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-28"></span><span class="annot"><a href="Parser.Helper.html#getLiteral"><span class="hs-identifier hs-var">getLiteral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#StringLiteral"><span class="hs-identifier hs-type">StringLiteral</span></a></span><span> </span><span id="local-6989586621679206490"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206490"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206490"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="annot"><a href="Parser.Helper.html#getOp"><span class="hs-identifier hs-type">getOp</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Lexer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-31"></span><span id="getOp"><span class="annot"><span class="annottext">getOp :: Token -&gt; Text
</span><a href="Parser.Helper.html#getOp"><span class="hs-identifier hs-var hs-var">getOp</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#IncrementOp"><span class="hs-identifier hs-type">IncrementOp</span></a></span><span> </span><span id="local-6989586621679206493"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206493"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206493"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-32"></span><span class="annot"><a href="Parser.Helper.html#getOp"><span class="hs-identifier hs-var">getOp</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Lexer.Token.html#CompoundAssignOp"><span class="hs-identifier hs-type">CompoundAssignOp</span></a></span><span> </span><span id="local-6989586621679206495"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206495"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679206495"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span id="local-6989586621679206443"><span id="local-6989586621679206445"><span class="annot"><a href="Parser.Helper.html#unionOf"><span class="hs-identifier hs-type">unionOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206443"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206445"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">Range</span></a></span></span></span><span>
</span><span id="line-35"></span><span id="unionOf"><span class="annot"><span class="annottext">unionOf :: forall a b. Located a -&gt; Located b -&gt; Range
</span><a href="Parser.Helper.html#unionOf"><span class="hs-identifier hs-var hs-var">unionOf</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679206498"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679206498"><span class="hs-identifier hs-var">loc1</span></a></span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679206499"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679206499"><span class="hs-identifier hs-var">loc2</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range -&gt; Range -&gt; Range
</span><a href="#local-6989586621679206500"><span class="hs-identifier hs-var">combineRanges</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679206498"><span class="hs-identifier hs-var">loc1</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679206499"><span class="hs-identifier hs-var">loc2</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-37"></span><span>    </span><span id="local-6989586621679206500"><span class="annot"><span class="annottext">combineRanges :: Range -&gt; Range -&gt; Range
</span><a href="#local-6989586621679206500"><span class="hs-identifier hs-var hs-var">combineRanges</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span> </span><span id="local-6989586621679206505"><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206505"><span class="hs-identifier hs-var">start1</span></a></span></span><span> </span><span id="local-6989586621679206506"><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206506"><span class="hs-identifier hs-var">stop1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span> </span><span id="local-6989586621679206507"><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206507"><span class="hs-identifier hs-var">start2</span></a></span></span><span> </span><span id="local-6989586621679206508"><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206508"><span class="hs-identifier hs-var">stop2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-38"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679206509"><span class="annot"><span class="annottext">start :: Posn
</span><a href="#local-6989586621679206509"><span class="hs-identifier hs-var hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Posn -&gt; Int
</span><a href="Util.SourceLoc.html#%24sel%3Aoffset%3APosn"><span class="hs-identifier hs-var">SL.offset</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206505"><span class="hs-identifier hs-var">start1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Posn -&gt; Int
</span><a href="Util.SourceLoc.html#%24sel%3Aoffset%3APosn"><span class="hs-identifier hs-var">SL.offset</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206507"><span class="hs-identifier hs-var">start2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206505"><span class="hs-identifier hs-var">start1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206507"><span class="hs-identifier hs-var">start2</span></a></span><span>
</span><span id="line-39"></span><span>          </span><span id="local-6989586621679206512"><span class="annot"><span class="annottext">stop :: Posn
</span><a href="#local-6989586621679206512"><span class="hs-identifier hs-var hs-var">stop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Posn -&gt; Int
</span><a href="Util.SourceLoc.html#%24sel%3Aoffset%3APosn"><span class="hs-identifier hs-var">SL.offset</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206506"><span class="hs-identifier hs-var">stop1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Posn -&gt; Int
</span><a href="Util.SourceLoc.html#%24sel%3Aoffset%3APosn"><span class="hs-identifier hs-var">SL.offset</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206508"><span class="hs-identifier hs-var">stop2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206506"><span class="hs-identifier hs-var">stop1</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206508"><span class="hs-identifier hs-var">stop2</span></a></span><span>
</span><span id="line-40"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Posn -&gt; Posn -&gt; Range
</span><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-var">SL.Range</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206509"><span class="hs-identifier hs-var">start</span></a></span><span> </span><span class="annot"><span class="annottext">Posn
</span><a href="#local-6989586621679206512"><span class="hs-identifier hs-var">stop</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span id="local-6989586621679206451"><span class="annot"><a href="Parser.Helper.html#lexerwrap"><span class="hs-identifier hs-type">lexerwrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Lexer.Token.html#Token"><span class="hs-identifier hs-type">Token</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lexer.Lex.html#Alex"><span class="hs-identifier hs-type">Alex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206451"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Lexer.Lex.html#Alex"><span class="hs-identifier hs-type">Alex</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679206451"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-43"></span><span id="lexerwrap"><span class="annot"><span class="annottext">lexerwrap :: forall a. (Located Token -&gt; Alex a) -&gt; Alex a
</span><a href="Parser.Helper.html#lexerwrap"><span class="hs-identifier hs-var hs-var">lexerwrap</span></a></span></span><span> </span><span id="local-6989586621679206517"><span class="annot"><span class="annottext">Located Token -&gt; Alex a
</span><a href="#local-6989586621679206517"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-44"></span><span>  </span><span id="local-6989586621679206518"><span class="annot"><span class="annottext">Located Token
</span><a href="#local-6989586621679206518"><span class="hs-identifier hs-var">token</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Alex (Located Token)
</span><a href="Lexer.Lex.html#alexMonadScan"><span class="hs-identifier hs-var">alexMonadScan</span></a></span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">Located Token -&gt; Alex a
</span><a href="#local-6989586621679206517"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">Located Token
</span><a href="#local-6989586621679206518"><span class="hs-identifier hs-var">token</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span id="parseError"><span class="annot"><span class="annottext">parseError :: Located a -&gt; Alex b
</span><a href="Parser.Helper.html#parseError"><span class="hs-identifier hs-var hs-var">parseError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679206528"><span class="annot"><span class="annottext">sl :: Range
</span><a href="#local-6989586621679206528"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#Posn"><span class="hs-identifier hs-type">SL.Posn</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679206530"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679206530"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span id="local-6989586621679206531"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679206531"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Posn
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679206532"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679206532"><span class="hs-identifier hs-var">tok</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="annottext">CompileError -&gt; Alex ()
</span><a href="Lexer.Lex.html#addError"><span class="hs-identifier hs-var">addError</span></a></span><span> </span><span class="annot"><span class="annottext">(CompileError -&gt; Alex ()) -&gt; CompileError -&gt; Alex ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Range -&gt; Text -&gt; CompileError
</span><a href="Types.html#CompileError"><span class="hs-identifier hs-var">CompileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe Range
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679206528"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Text -&gt; CompileError) -&gt; Text -&gt; CompileError
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Text (a -&gt; Text) -&gt; a -&gt; Text
forall a. Format Text a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (a -&gt; Text) (a -&gt; Text)
</span><span class="hs-string">&quot;Error handling token '&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (a -&gt; Text) (a -&gt; Text)
-&gt; Format Text (a -&gt; Text) -&gt; Format Text (a -&gt; Text)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Text (a -&gt; Text)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Text (a -&gt; Text)
-&gt; Format Text Text -&gt; Format Text (a -&gt; Text)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Text Text
</span><span class="hs-string">&quot;'&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679206532"><span class="hs-identifier hs-var">tok</span></a></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Alex b
forall a. String -&gt; Alex a
</span><a href="Lexer.Lex.html#alexError"><span class="hs-identifier hs-var">alexError</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Parser failed.&quot;</span></span><span>
</span><span id="line-50"></span></pre></body></html>