<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (C) 2018-2024 Jun Zhang &lt;zhangjunphy[at]gmail[dot]com&gt;</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- This file is a part of decafc.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- decafc is free software: you can redistribute it and/or modify it under the</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- terms of the MIT (X11) License as described in the LICENSE file.</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">-- decafc is distributed in the hope that it will be useful, but WITHOUT ANY</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- FOR A PARTICULAR PURPOSE.  See the X11 license for more details.</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- Semantic -- Decaf semantic checker</span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Semantic</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Semantic.html#analyze"><span class="hs-identifier">analyze</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-15"></span><span>    </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier">SymbolTable</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Semantic.html#SemanticInfo"><span class="hs-identifier">SemanticInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>    </span><span class="annot"><a href="Semantic.html#BlockType"><span class="hs-identifier">BlockType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>    </span><span class="annot"><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier">lookupLocalVariableFromST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>    </span><span class="annot"><a href="Semantic.html#lookupLocalMethodFromST"><span class="hs-identifier">lookupLocalMethodFromST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="AST.html"><span class="hs-identifier">AST</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.Constants.html"><span class="hs-identifier">Util.Constants</span></a></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;|&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">view</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%=)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(^.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer.Lazy</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Functor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;&amp;&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Generics.Labels</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Int64</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">find</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isJust</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Read</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Formatting</span></span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Parser.html"><span class="hs-identifier">Parser</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">P</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Types.html"><span class="hs-identifier">Types</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Util.SourceLoc.html"><span class="hs-identifier">Util.SourceLoc</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">SL</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">---------------------------------------</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- Semantic informations and errors</span><span>
</span><span id="line-51"></span><span class="hs-comment">---------------------------------------</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span> </span><span id="BlockType"><span class="annot"><a href="Semantic.html#BlockType"><span class="hs-identifier hs-var">BlockType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RootBlock"><span class="annot"><a href="Semantic.html#RootBlock"><span class="hs-identifier hs-var">RootBlock</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="IfBlock"><span class="annot"><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="ForBlock"><span class="annot"><a href="Semantic.html#ForBlock"><span class="hs-identifier hs-var">ForBlock</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="WhileBlock"><span class="annot"><a href="Semantic.html#WhileBlock"><span class="hs-identifier hs-var">WhileBlock</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="MethodBlock"><span class="annot"><a href="Semantic.html#MethodBlock"><span class="hs-identifier hs-var">MethodBlock</span></a></span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203962"><span id="local-6989586621679203964"><span id="local-6989586621679203968"><span class="annot"><span class="annottext">ScopeID -&gt; BlockType -&gt; ShowS
[BlockType] -&gt; ShowS
BlockType -&gt; String
(ScopeID -&gt; BlockType -&gt; ShowS)
-&gt; (BlockType -&gt; String)
-&gt; ([BlockType] -&gt; ShowS)
-&gt; Show BlockType
forall a.
(ScopeID -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: ScopeID -&gt; BlockType -&gt; ShowS
showsPrec :: ScopeID -&gt; BlockType -&gt; ShowS
$cshow :: BlockType -&gt; String
show :: BlockType -&gt; String
$cshowList :: [BlockType] -&gt; ShowS
showList :: [BlockType] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679203972"><span id="local-6989586621679203974"><span class="annot"><span class="annottext">BlockType -&gt; BlockType -&gt; Bool
(BlockType -&gt; BlockType -&gt; Bool)
-&gt; (BlockType -&gt; BlockType -&gt; Bool) -&gt; Eq BlockType
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BlockType -&gt; BlockType -&gt; Bool
== :: BlockType -&gt; BlockType -&gt; Bool
$c/= :: BlockType -&gt; BlockType -&gt; Bool
/= :: BlockType -&gt; BlockType -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-comment">-- symbol table definitions</span><span>
</span><span id="line-57"></span><span class="hs-keyword">data</span><span> </span><span id="SymbolTable"><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SymbolTable"><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-var">SymbolTable</span></a></span></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AscopeID%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var hs-var">scopeID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>    </span><span id="%24sel%3Aparent%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var hs-var">parent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>    </span><span id="%24sel%3AimportSymbols%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var hs-var">importSymbols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>    </span><span id="%24sel%3AvariableSymbols%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var hs-var">variableSymbols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>    </span><span id="%24sel%3AmethodSymbols%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var hs-var">methodSymbols</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-63"></span><span>    </span><span id="%24sel%3Aarguments%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name Argument)
</span><a href="Semantic.html#%24sel%3Aarguments%3ASymbolTable"><span class="hs-identifier hs-var hs-var">arguments</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>    </span><span id="%24sel%3AblockType%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var hs-var">blockType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#BlockType"><span class="hs-identifier hs-type">BlockType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>    </span><span id="%24sel%3AmethodSig%3ASymbolTable"><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe MethodSig
</span><a href="Semantic.html#%24sel%3AmethodSig%3ASymbolTable"><span class="hs-identifier hs-var hs-var">methodSig</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679203988"><span id="local-6989586621679203990"><span class="annot"><span class="annottext">(forall x. SymbolTable -&gt; Rep SymbolTable x)
-&gt; (forall x. Rep SymbolTable x -&gt; SymbolTable)
-&gt; Generic SymbolTable
forall x. Rep SymbolTable x -&gt; SymbolTable
forall x. SymbolTable -&gt; Rep SymbolTable x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SymbolTable -&gt; Rep SymbolTable x
from :: forall x. SymbolTable -&gt; Rep SymbolTable x
$cto :: forall x. Rep SymbolTable x -&gt; SymbolTable
to :: forall x. Rep SymbolTable x -&gt; SymbolTable
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679203994"><span id="local-6989586621679203999"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>  </span><span id="local-6989586621679204037"><span class="annot"><span class="annottext">show :: SymbolTable -&gt; String
</span><a href="#local-6989586621679204037"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span id="local-6989586621679204039"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204039"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span id="local-6989586621679204040"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204040"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679204041"><span class="annot"><span class="annottext">Maybe (Map Name ImportDecl)
</span><a href="#local-6989586621679204041"><span class="hs-identifier hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621679204042"><span class="annot"><span class="annottext">Map Name FieldDecl
</span><a href="#local-6989586621679204042"><span class="hs-identifier hs-var">variables</span></a></span></span><span> </span><span id="local-6989586621679204043"><span class="annot"><span class="annottext">Maybe (Map Name MethodDecl)
</span><a href="#local-6989586621679204043"><span class="hs-identifier hs-var">methods</span></a></span></span><span> </span><span id="local-6989586621679204044"><span class="annot"><span class="annottext">Maybe (Map Name Argument)
</span><a href="#local-6989586621679204044"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679204045"><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204045"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="annottext">Format
  String
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; ScopeID
-&gt; Maybe ScopeID
-&gt; Maybe (Map Name ImportDecl)
-&gt; Map Name FieldDecl
-&gt; Maybe (Map Name MethodDecl)
-&gt; Maybe (Map Name Argument)
-&gt; BlockType
-&gt; String
forall a. Format String a -&gt; a
</span><span class="hs-identifier hs-var">formatToString</span></span><span>
</span><span id="line-72"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
</span><span class="hs-string">&quot;SymbolTable {scopeID=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (ScopeID
      -&gt; Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (ScopeID
      -&gt; Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (ScopeID
   -&gt; Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (ScopeID
      -&gt; Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
</span><span class="hs-string">&quot;, parent=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe ScopeID
   -&gt; Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (Maybe ScopeID
      -&gt; Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
</span><span class="hs-string">&quot;, imports=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Maybe (Map Name ImportDecl)
   -&gt; Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name ImportDecl)
      -&gt; Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
</span><span class="hs-string">&quot;, variables=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
-&gt; Format
     String
     (Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Map Name FieldDecl
   -&gt; Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument)
   -&gt; BlockType
   -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format
     String
     (Map Name FieldDecl
      -&gt; Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument)
      -&gt; BlockType
      -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
</span><span class="hs-string">&quot;, methods=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name MethodDecl)
   -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format String (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format
     String
     (Maybe (Map Name MethodDecl)
      -&gt; Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
</span><span class="hs-string">&quot;, arguments=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format String (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format String (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (BlockType -&gt; String)
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format
  (BlockType -&gt; String)
  (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
-&gt; Format String (BlockType -&gt; String)
-&gt; Format String (Maybe (Map Name Argument) -&gt; BlockType -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (BlockType -&gt; String) (BlockType -&gt; String)
</span><span class="hs-string">&quot;, tpe=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (BlockType -&gt; String) (BlockType -&gt; String)
-&gt; Format String (BlockType -&gt; String)
-&gt; Format String (BlockType -&gt; String)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format String (BlockType -&gt; String)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204039"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolTable -&gt; ScopeID) -&gt; Maybe SymbolTable -&gt; Maybe ScopeID
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204040"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Map Name ImportDecl)
</span><a href="#local-6989586621679204041"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-76"></span><span>      </span><span class="annot"><span class="annottext">Map Name FieldDecl
</span><a href="#local-6989586621679204042"><span class="hs-identifier hs-var">variables</span></a></span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Map Name MethodDecl)
</span><a href="#local-6989586621679204043"><span class="hs-identifier hs-var">methods</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">Maybe (Map Name Argument)
</span><a href="#local-6989586621679204044"><span class="hs-identifier hs-var">arguments</span></a></span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204045"><span class="hs-identifier hs-var">tpe</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">data</span><span> </span><span id="SemanticState"><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-var">SemanticState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SemanticState"><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-var">SemanticState</span></a></span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AnextScopeID%3ASemanticState"><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AnextScopeID%3ASemanticState"><span class="hs-identifier hs-var hs-var">nextScopeID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>    </span><span id="%24sel%3AcurrentScopeID%3ASemanticState"><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var hs-var">currentScopeID</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>    </span><span id="%24sel%3AsymbolTables%3ASemanticState"><span class="annot"><span class="annottext">SemanticState -&gt; Map ScopeID SymbolTable
</span><a href="Semantic.html#%24sel%3AsymbolTables%3ASemanticState"><span class="hs-identifier hs-var hs-var">symbolTables</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-85"></span><span>    </span><span id="%24sel%3AcurrentRange%3ASemanticState"><span class="annot"><span class="annottext">SemanticState -&gt; Range
</span><a href="Semantic.html#%24sel%3AcurrentRange%3ASemanticState"><span class="hs-identifier hs-var hs-var">currentRange</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>    </span><span id="%24sel%3AsymbolWrites%3ASemanticState"><span class="annot"><span class="annottext">SemanticState -&gt; Map ScopeID (Set (ScopeID, Name))
</span><a href="Semantic.html#%24sel%3AsymbolWrites%3ASemanticState"><span class="hs-identifier hs-var hs-var">symbolWrites</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679204058"><span id="local-6989586621679204069"><span id="local-6989586621679204073"><span class="annot"><span class="annottext">ScopeID -&gt; SemanticState -&gt; ShowS
[SemanticState] -&gt; ShowS
SemanticState -&gt; String
(ScopeID -&gt; SemanticState -&gt; ShowS)
-&gt; (SemanticState -&gt; String)
-&gt; ([SemanticState] -&gt; ShowS)
-&gt; Show SemanticState
forall a.
(ScopeID -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: ScopeID -&gt; SemanticState -&gt; ShowS
showsPrec :: ScopeID -&gt; SemanticState -&gt; ShowS
$cshow :: SemanticState -&gt; String
show :: SemanticState -&gt; String
$cshowList :: [SemanticState] -&gt; ShowS
showList :: [SemanticState] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204079"><span id="local-6989586621679204081"><span class="annot"><span class="annottext">(forall x. SemanticState -&gt; Rep SemanticState x)
-&gt; (forall x. Rep SemanticState x -&gt; SemanticState)
-&gt; Generic SemanticState
forall x. Rep SemanticState x -&gt; SemanticState
forall x. SemanticState -&gt; Rep SemanticState x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SemanticState -&gt; Rep SemanticState x
from :: forall x. SemanticState -&gt; Rep SemanticState x
$cto :: forall x. Rep SemanticState x -&gt; SemanticState
to :: forall x. Rep SemanticState x -&gt; SemanticState
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">data</span><span> </span><span id="SemanticInfo"><span class="annot"><a href="Semantic.html#SemanticInfo"><span class="hs-identifier hs-var">SemanticInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SemanticInfo"><span class="annot"><a href="Semantic.html#SemanticInfo"><span class="hs-identifier hs-var">SemanticInfo</span></a></span></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AsymbolTables%3ASemanticInfo"><span class="annot"><span class="annottext">SemanticInfo -&gt; Map ScopeID SymbolTable
</span><a href="Semantic.html#%24sel%3AsymbolTables%3ASemanticInfo"><span class="hs-identifier hs-var hs-var">symbolTables</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span id="%24sel%3AsymbolWrites%3ASemanticInfo"><span class="annot"><span class="annottext">SemanticInfo -&gt; Map ScopeID (Set (ScopeID, Name))
</span><a href="Semantic.html#%24sel%3AsymbolWrites%3ASemanticInfo"><span class="hs-identifier hs-var hs-var">symbolWrites</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679204086"><span id="local-6989586621679204094"><span id="local-6989586621679204098"><span class="annot"><span class="annottext">ScopeID -&gt; SemanticInfo -&gt; ShowS
[SemanticInfo] -&gt; ShowS
SemanticInfo -&gt; String
(ScopeID -&gt; SemanticInfo -&gt; ShowS)
-&gt; (SemanticInfo -&gt; String)
-&gt; ([SemanticInfo] -&gt; ShowS)
-&gt; Show SemanticInfo
forall a.
(ScopeID -&gt; a -&gt; ShowS)
-&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: ScopeID -&gt; SemanticInfo -&gt; ShowS
showsPrec :: ScopeID -&gt; SemanticInfo -&gt; ShowS
$cshow :: SemanticInfo -&gt; String
show :: SemanticInfo -&gt; String
$cshowList :: [SemanticInfo] -&gt; ShowS
showList :: [SemanticInfo] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204102"><span id="local-6989586621679204104"><span class="annot"><span class="annottext">(forall x. SemanticInfo -&gt; Rep SemanticInfo x)
-&gt; (forall x. Rep SemanticInfo x -&gt; SemanticInfo)
-&gt; Generic SemanticInfo
forall x. Rep SemanticInfo x -&gt; SemanticInfo
forall x. SemanticInfo -&gt; Rep SemanticInfo x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. SemanticInfo -&gt; Rep SemanticInfo x
from :: forall x. SemanticInfo -&gt; Rep SemanticInfo x
$cto :: forall x. Rep SemanticInfo x -&gt; SemanticInfo
to :: forall x. Rep SemanticInfo x -&gt; SemanticInfo
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- Monad used for semantic analysis</span><span>
</span><span id="line-96"></span><span class="hs-comment">-- Symbol tables are built for every scope, and stored in SemanticState.</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- Semantic errors encountered are recorded by the writer monad (WriterT [CompileError]).</span><span>
</span><span id="line-98"></span><span class="hs-comment">-- If a serious problem happened such that the analysis has to be aborted, a CompileError </span><span>
</span><span id="line-99"></span><span class="hs-comment">-- is thrown as an exception.</span><span>
</span><span id="line-100"></span><span class="hs-keyword">newtype</span><span> </span><span id="Semantic"><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-var">Semantic</span></a></span></span><span> </span><span id="local-6989586621679202885"><span class="annot"><a href="#local-6989586621679202885"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Semantic"><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-var">Semantic</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3ArunSemantic%3ASemantic"><span class="annot"><span class="annottext">forall a.
Semantic a
-&gt; ExceptT
     CompileError (WriterT [CompileError] (State SemanticState)) a
</span><a href="Semantic.html#%24sel%3ArunSemantic%3ASemantic"><span class="hs-identifier hs-var hs-var">runSemantic</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier hs-type">CompileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier hs-type">CompileError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-type">SemanticState</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679202885"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679204109"><span id="local-6989586621679204115"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Semantic a -&gt; Semantic b)
-&gt; (forall a b. a -&gt; Semantic b -&gt; Semantic a) -&gt; Functor Semantic
forall a b. a -&gt; Semantic b -&gt; Semantic a
forall a b. (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
fmap :: forall a b. (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
$c&lt;$ :: forall a b. a -&gt; Semantic b -&gt; Semantic a
&lt;$ :: forall a b. a -&gt; Semantic b -&gt; Semantic a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204127"><span id="local-6989586621679204134"><span id="local-6989586621679204140"><span id="local-6989586621679204146"><span id="local-6989586621679204152"><span class="annot"><span class="annottext">Functor Semantic
Functor Semantic
-&gt; (forall a. a -&gt; Semantic a)
-&gt; (forall a b. Semantic (a -&gt; b) -&gt; Semantic a -&gt; Semantic b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; Semantic a -&gt; Semantic b -&gt; Semantic c)
-&gt; (forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b)
-&gt; (forall a b. Semantic a -&gt; Semantic b -&gt; Semantic a)
-&gt; Applicative Semantic
forall a. a -&gt; Semantic a
forall a b. Semantic a -&gt; Semantic b -&gt; Semantic a
forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
forall a b. Semantic (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
forall a b c.
(a -&gt; b -&gt; c) -&gt; Semantic a -&gt; Semantic b -&gt; Semantic c
forall (f :: * -&gt; *).
Functor f
-&gt; (forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
$cpure :: forall a. a -&gt; Semantic a
pure :: forall a. a -&gt; Semantic a
$c&lt;*&gt; :: forall a b. Semantic (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
&lt;*&gt; :: forall a b. Semantic (a -&gt; b) -&gt; Semantic a -&gt; Semantic b
$cliftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Semantic a -&gt; Semantic b -&gt; Semantic c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; Semantic a -&gt; Semantic b -&gt; Semantic c
$c*&gt; :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
*&gt; :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
$c&lt;* :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic a
&lt;* :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204185"><span id="local-6989586621679204191"><span id="local-6989586621679204196"><span class="annot"><span class="annottext">Applicative Semantic
Applicative Semantic
-&gt; (forall a b. Semantic a -&gt; (a -&gt; Semantic b) -&gt; Semantic b)
-&gt; (forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b)
-&gt; (forall a. a -&gt; Semantic a)
-&gt; Monad Semantic
forall a. a -&gt; Semantic a
forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
forall a b. Semantic a -&gt; (a -&gt; Semantic b) -&gt; Semantic b
forall (m :: * -&gt; *).
Applicative m
-&gt; (forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
$c&gt;&gt;= :: forall a b. Semantic a -&gt; (a -&gt; Semantic b) -&gt; Semantic b
&gt;&gt;= :: forall a b. Semantic a -&gt; (a -&gt; Semantic b) -&gt; Semantic b
$c&gt;&gt; :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
&gt;&gt; :: forall a b. Semantic a -&gt; Semantic b -&gt; Semantic b
$creturn :: forall a. a -&gt; Semantic a
return :: forall a. a -&gt; Semantic a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204213"><span id="local-6989586621679204219"><span class="annot"><span class="hs-identifier hs-type">MonadError</span></span><span> </span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier hs-type">CompileError</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204236"><span id="local-6989586621679204242"><span id="local-6989586621679204247"><span id="local-6989586621679204252"><span class="annot"><span class="hs-identifier hs-type">MonadWriter</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier hs-type">CompileError</span></a></span><span class="hs-special">]</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204273"><span id="local-6989586621679204279"><span id="local-6989586621679204284"><span class="annot"><span class="hs-identifier hs-type">MonadState</span></span><span> </span><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-type">SemanticState</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Semantic.html#analyze"><span class="hs-identifier hs-type">analyze</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Program"><span class="hs-identifier hs-type">P.Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Types.html#CompileError"><span class="hs-identifier hs-type">CompileError</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ASTRoot"><span class="hs-identifier hs-type">ASTRoot</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Semantic.html#SemanticInfo"><span class="hs-identifier hs-type">SemanticInfo</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span id="analyze"><span class="annot"><span class="annottext">analyze :: Program -&gt; Either [CompileError] (ASTRoot, SemanticInfo)
</span><a href="Semantic.html#analyze"><span class="hs-identifier hs-var hs-var">analyze</span></a></span></span><span> </span><span id="local-6989586621679204300"><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679204300"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204301"><span class="annot"><span class="annottext">ir :: Semantic ASTRoot
</span><a href="#local-6989586621679204301"><span class="hs-identifier hs-var hs-var">ir</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Program -&gt; Semantic ASTRoot
</span><a href="Semantic.html#irgenRoot"><span class="hs-identifier hs-var">irgenRoot</span></a></span><span> </span><span class="annot"><span class="annottext">Program
</span><a href="#local-6989586621679204300"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679204303"><span class="annot"><span class="annottext">Either CompileError ASTRoot
</span><a href="#local-6989586621679204303"><span class="hs-identifier hs-var">except</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204304"><span class="annot"><span class="annottext">[CompileError]
</span><a href="#local-6989586621679204304"><span class="hs-identifier hs-var">errors</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679204305"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204305"><span class="hs-identifier hs-var">state</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State SemanticState (Either CompileError ASTRoot, [CompileError])
-&gt; SemanticState
-&gt; ((Either CompileError ASTRoot, [CompileError]), SemanticState)
forall s a. State s a -&gt; s -&gt; (a, s)
</span><span class="hs-identifier hs-var">runState</span></span><span> </span><span class="annot"><span class="annottext">(State SemanticState (Either CompileError ASTRoot, [CompileError])
 -&gt; SemanticState
 -&gt; ((Either CompileError ASTRoot, [CompileError]), SemanticState))
-&gt; State
     SemanticState (Either CompileError ASTRoot, [CompileError])
-&gt; SemanticState
-&gt; ((Either CompileError ASTRoot, [CompileError]), SemanticState)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">WriterT
  [CompileError] (State SemanticState) (Either CompileError ASTRoot)
-&gt; State
     SemanticState (Either CompileError ASTRoot, [CompileError])
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="annot"><span class="annottext">(WriterT
   [CompileError] (State SemanticState) (Either CompileError ASTRoot)
 -&gt; State
      SemanticState (Either CompileError ASTRoot, [CompileError]))
-&gt; WriterT
     [CompileError] (State SemanticState) (Either CompileError ASTRoot)
-&gt; State
     SemanticState (Either CompileError ASTRoot, [CompileError])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ExceptT
  CompileError (WriterT [CompileError] (State SemanticState)) ASTRoot
-&gt; WriterT
     [CompileError] (State SemanticState) (Either CompileError ASTRoot)
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT
   CompileError (WriterT [CompileError] (State SemanticState)) ASTRoot
 -&gt; WriterT
      [CompileError] (State SemanticState) (Either CompileError ASTRoot))
-&gt; ExceptT
     CompileError (WriterT [CompileError] (State SemanticState)) ASTRoot
-&gt; WriterT
     [CompileError] (State SemanticState) (Either CompileError ASTRoot)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Semantic ASTRoot
-&gt; ExceptT
     CompileError (WriterT [CompileError] (State SemanticState)) ASTRoot
forall a.
Semantic a
-&gt; ExceptT
     CompileError (WriterT [CompileError] (State SemanticState)) a
</span><a href="Semantic.html#%24sel%3ArunSemantic%3ASemantic"><span class="hs-identifier hs-var">runSemantic</span></a></span><span> </span><span class="annot"><span class="annottext">Semantic ASTRoot
</span><a href="#local-6989586621679204301"><span class="hs-identifier hs-var">ir</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="Semantic.html#initialSemanticState"><span class="hs-identifier hs-var">initialSemanticState</span></a></span><span>
</span><span id="line-107"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either CompileError ASTRoot
</span><a href="#local-6989586621679204303"><span class="hs-identifier hs-var">except</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-108"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679204310"><span class="annot"><span class="annottext">CompileError
</span><a href="#local-6989586621679204310"><span class="hs-identifier hs-var">except</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CompileError] -&gt; Either [CompileError] (ASTRoot, SemanticInfo)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">CompileError
</span><a href="#local-6989586621679204310"><span class="hs-identifier hs-var">except</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-109"></span><span>        </span><span class="annot"><span class="annottext">Either CompileError ASTRoot
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; Bool -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[CompileError] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[CompileError]
</span><a href="#local-6989586621679204304"><span class="hs-identifier hs-var">errors</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[CompileError] -&gt; Either [CompileError] (ASTRoot, SemanticInfo)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">[CompileError]
</span><a href="#local-6989586621679204304"><span class="hs-identifier hs-var">errors</span></a></span><span>
</span><span id="line-110"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679204313"><span class="annot"><span class="annottext">ASTRoot
</span><a href="#local-6989586621679204313"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(ASTRoot, SemanticInfo)
-&gt; Either [CompileError] (ASTRoot, SemanticInfo)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ASTRoot
</span><a href="#local-6989586621679204313"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Map ScopeID SymbolTable
-&gt; Map ScopeID (Set (ScopeID, Name)) -&gt; SemanticInfo
</span><a href="Semantic.html#SemanticInfo"><span class="hs-identifier hs-var">SemanticInfo</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204305"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
-&gt; Getting
     (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
-&gt; Map ScopeID SymbolTable
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
</span><span class="">#symbolTables</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204305"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
-&gt; Getting
     (Map ScopeID (Set (ScopeID, Name)))
     SemanticState
     (Map ScopeID (Set (ScopeID, Name)))
-&gt; Map ScopeID (Set (ScopeID, Name))
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map ScopeID (Set (ScopeID, Name)))
  SemanticState
  (Map ScopeID (Set (ScopeID, Name)))
</span><span class="">#symbolWrites</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="annot"><a href="Semantic.html#initialSemanticState"><span class="hs-identifier hs-type">initialSemanticState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-type">SemanticState</span></a></span><span>
</span><span id="line-113"></span><span id="initialSemanticState"><span class="annot"><span class="annottext">initialSemanticState :: SemanticState
</span><a href="Semantic.html#initialSemanticState"><span class="hs-identifier hs-var hs-var">initialSemanticState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204314"><span class="annot"><span class="annottext">globalST :: SymbolTable
</span><a href="#local-6989586621679204314"><span class="hs-identifier hs-var hs-var">globalST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span>
</span><span id="line-116"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:scopeID:SymbolTable :: ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="Util.Constants.html#globalScopeID"><span class="hs-identifier hs-var">globalScopeID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span>            </span><span class="annot"><span class="annottext">$sel:parent:SymbolTable :: Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-118"></span><span>            </span><span class="annot"><span class="annottext">$sel:importSymbols:SymbolTable :: Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var">importSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl -&gt; Maybe (Map Name ImportDecl)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>            </span><span class="annot"><span class="annottext">$sel:variableSymbols:SymbolTable :: Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name FieldDecl
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-120"></span><span>            </span><span class="annot"><span class="annottext">$sel:methodSymbols:SymbolTable :: Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl -&gt; Maybe (Map Name MethodDecl)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>            </span><span class="annot"><span class="annottext">$sel:arguments:SymbolTable :: Maybe (Map Name Argument)
</span><a href="Semantic.html#%24sel%3Aarguments%3ASymbolTable"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Name Argument)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>            </span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#RootBlock"><span class="hs-identifier hs-var">RootBlock</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>            </span><span class="annot"><span class="annottext">$sel:methodSig:SymbolTable :: Maybe MethodSig
</span><a href="Semantic.html#%24sel%3AmethodSig%3ASymbolTable"><span class="hs-identifier hs-var">methodSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-124"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-125"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><a href="Semantic.html#SemanticState"><span class="hs-identifier hs-type">SemanticState</span></a></span><span>
</span><span id="line-126"></span><span>        </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:nextScopeID:SemanticState :: ScopeID
</span><a href="Semantic.html#%24sel%3AnextScopeID%3ASemanticState"><span class="hs-identifier hs-var">nextScopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="Util.Constants.html#globalScopeID"><span class="hs-identifier hs-var">globalScopeID</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; ScopeID
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>          </span><span class="annot"><span class="annottext">$sel:currentScopeID:SemanticState :: ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="Util.Constants.html#globalScopeID"><span class="hs-identifier hs-var">globalScopeID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>          </span><span class="annot"><span class="annottext">$sel:symbolTables:SemanticState :: Map ScopeID SymbolTable
</span><a href="Semantic.html#%24sel%3AsymbolTables%3ASemanticState"><span class="hs-identifier hs-var">symbolTables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ScopeID, SymbolTable)] -&gt; Map ScopeID SymbolTable
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeID
</span><a href="Util.Constants.html#globalScopeID"><span class="hs-identifier hs-var">globalScopeID</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204314"><span class="hs-identifier hs-var">globalST</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><span class="annottext">$sel:currentRange:SemanticState :: Range
</span><a href="Semantic.html#%24sel%3AcurrentRange%3ASemanticState"><span class="hs-identifier hs-var">currentRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Posn -&gt; Posn -&gt; Range
</span><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-var">SL.Range</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; ScopeID -&gt; Posn
</span><a href="Util.SourceLoc.html#Posn"><span class="hs-identifier hs-var">SL.Posn</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; ScopeID -&gt; Posn
</span><a href="Util.SourceLoc.html#Posn"><span class="hs-identifier hs-var">SL.Posn</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-130"></span><span>          </span><span class="annot"><span class="annottext">$sel:symbolWrites:SemanticState :: Map ScopeID (Set (ScopeID, Name))
</span><a href="Semantic.html#%24sel%3AsymbolWrites%3ASemanticState"><span class="hs-identifier hs-var">symbolWrites</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map ScopeID (Set (ScopeID, Name))
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-131"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-132"></span><span>
</span><span id="line-133"></span><span class="annot"><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-type">updateCurrentRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span id="updateCurrentRange"><span class="annot"><span class="annottext">updateCurrentRange :: Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var hs-var">updateCurrentRange</span></a></span></span><span> </span><span id="local-6989586621679204322"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204322"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SemanticState -&gt; SemanticState) -&gt; Semantic ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679204324"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204324"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204324"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:currentRange:SemanticState :: Range
</span><a href="Semantic.html#%24sel%3AcurrentRange%3ASemanticState"><span class="hs-identifier hs-var">currentRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204322"><span class="hs-identifier hs-var">range</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-type">getCurrentRange</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Range"><span class="hs-identifier hs-type">SL.Range</span></a></span><span>
</span><span id="line-137"></span><span id="getCurrentRange"><span class="annot"><span class="annottext">getCurrentRange :: Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var hs-var">getCurrentRange</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SemanticState -&gt; Range) -&gt; Semantic Range
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">SemanticState -&gt; Range
</span><a href="Semantic.html#%24sel%3AcurrentRange%3ASemanticState"><span class="hs-identifier hs-var">currentRange</span></a></span><span>
</span><span id="line-138"></span><span>
</span><span id="line-139"></span><span class="hs-comment">-- throw exception or store errors</span><span>
</span><span id="line-140"></span><span id="local-6989586621679203012"><span class="annot"><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-type">throwSemanticException</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679203012"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-141"></span><span id="throwSemanticException"><span class="annot"><span class="annottext">throwSemanticException :: forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var hs-var">throwSemanticException</span></a></span></span><span> </span><span id="local-6989586621679204330"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204330"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679204331"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204331"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">CompileError -&gt; Semantic a
forall a. CompileError -&gt; Semantic a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">(CompileError -&gt; Semantic a) -&gt; CompileError -&gt; Semantic a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe Range -&gt; Name -&gt; CompileError
</span><a href="Types.html#CompileError"><span class="hs-identifier hs-var">CompileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe Range
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204331"><span class="hs-identifier hs-var">range</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204330"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-type">addSemanticError</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span id="addSemanticError"><span class="annot"><span class="annottext">addSemanticError :: Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var hs-var">addSemanticError</span></a></span></span><span> </span><span id="local-6989586621679204335"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204335"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>  </span><span id="local-6989586621679204336"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204336"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">[CompileError] -&gt; Semantic ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">tell</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Maybe Range -&gt; Name -&gt; CompileError
</span><a href="Types.html#CompileError"><span class="hs-identifier hs-var">CompileError</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Range -&gt; Maybe Range
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204336"><span class="hs-identifier hs-var">range</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204335"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- find symbol table for global scope</span><span>
</span><span id="line-151"></span><span class="annot"><a href="Semantic.html#getGlobalSymbolTable%27"><span class="hs-identifier hs-type">getGlobalSymbolTable'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span>
</span><span id="line-152"></span><span id="getGlobalSymbolTable%27"><span class="annot"><span class="annottext">getGlobalSymbolTable' :: Semantic SymbolTable
</span><a href="Semantic.html#getGlobalSymbolTable%27"><span class="hs-identifier hs-var hs-var">getGlobalSymbolTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679204339"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204339"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SemanticState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; Map ScopeID SymbolTable -&gt; Maybe SymbolTable
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="Util.Constants.html#globalScopeID"><span class="hs-identifier hs-var">globalScopeID</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ScopeID SymbolTable -&gt; Maybe SymbolTable)
-&gt; Map ScopeID SymbolTable -&gt; Maybe SymbolTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204339"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
-&gt; Getting
     (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
-&gt; Map ScopeID SymbolTable
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
</span><span class="">#symbolTables</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic SymbolTable
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;No global symbol table found!&quot;</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204342"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204342"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Semantic SymbolTable
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204342"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">-- find symbol table for current scope</span><span>
</span><span id="line-159"></span><span class="annot"><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-type">getSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span id="getSymbolTable"><span class="annot"><span class="annottext">getSymbolTable :: Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var hs-var">getSymbolTable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679204344"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204344"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SemanticState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204345"><span class="annot"><span class="annottext">id :: ScopeID
</span><a href="#local-6989586621679204345"><span class="hs-identifier hs-var hs-var">id</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204344"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-163"></span><span>  </span><span class="annot"><span class="annottext">Maybe SymbolTable -&gt; Semantic (Maybe SymbolTable)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe SymbolTable -&gt; Semantic (Maybe SymbolTable))
-&gt; Maybe SymbolTable -&gt; Semantic (Maybe SymbolTable)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; Map ScopeID SymbolTable -&gt; Maybe SymbolTable
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204345"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ScopeID SymbolTable -&gt; Maybe SymbolTable)
-&gt; Map ScopeID SymbolTable -&gt; Maybe SymbolTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204344"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
-&gt; Getting
     (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
-&gt; Map ScopeID SymbolTable
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
</span><span class="">#symbolTables</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Semantic.html#getCurrentScopeID"><span class="hs-identifier hs-type">getCurrentScopeID</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-166"></span><span id="getCurrentScopeID"><span class="annot"><span class="annottext">getCurrentScopeID :: Semantic ScopeID
</span><a href="Semantic.html#getCurrentScopeID"><span class="hs-identifier hs-var hs-var">getCurrentScopeID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SemanticState -&gt; ScopeID) -&gt; Semantic ScopeID
forall s (m :: * -&gt; *) a. MonadState s m =&gt; (s -&gt; a) -&gt; m a
</span><span class="hs-identifier hs-var">gets</span></span><span> </span><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="hs-comment">-- find symbol table for current scope</span><span>
</span><span id="line-169"></span><span class="hs-comment">-- will throw SemanticException if nothing is found</span><span>
</span><span id="line-170"></span><span class="annot"><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-type">getSymbolTable'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span>
</span><span id="line-171"></span><span id="getSymbolTable%27"><span class="annot"><span class="annottext">getSymbolTable' :: Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var hs-var">getSymbolTable'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679204348"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204348"><span class="hs-identifier hs-var">scopeID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic ScopeID
</span><a href="Semantic.html#getCurrentScopeID"><span class="hs-identifier hs-var">getCurrentScopeID</span></a></span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679204349"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204349"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var">getSymbolTable</span></a></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204349"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Semantic SymbolTable
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic SymbolTable) -&gt; Name -&gt; Semantic SymbolTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
</span><span class="hs-string">&quot;No symble table found for current scope &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name) -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204348"><span class="hs-identifier hs-var">scopeID</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204351"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204351"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Semantic SymbolTable
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204351"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Semantic.html#getLocalVariables%27"><span class="hs-identifier hs-type">getLocalVariables'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span id="getLocalVariables%27"><span class="annot"><span class="annottext">getLocalVariables' :: Semantic (Map Name FieldDecl)
</span><a href="Semantic.html#getLocalVariables%27"><span class="hs-identifier hs-var hs-var">getLocalVariables'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable -&gt; Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolTable -&gt; Map Name FieldDecl)
-&gt; Semantic SymbolTable -&gt; Semantic (Map Name FieldDecl)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><a href="Semantic.html#getLocalImports%27"><span class="hs-identifier hs-type">getLocalImports'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span id="getLocalImports%27"><span class="annot"><span class="annottext">getLocalImports' :: Semantic (Map Name ImportDecl)
</span><a href="Semantic.html#getLocalImports%27"><span class="hs-identifier hs-var hs-var">getLocalImports'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679204354"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204354"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var">importSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204354"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Map Name ImportDecl)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Map Name ImportDecl)
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic (Map Name ImportDecl))
-&gt; Name -&gt; Semantic (Map Name ImportDecl)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
</span><span class="hs-string">&quot;No import table for scope &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name) -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204354"><span class="hs-identifier hs-var">localST</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204355"><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204355"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl -&gt; Semantic (Map Name ImportDecl)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204355"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="annot"><a href="Semantic.html#getLocalMethods%27"><span class="hs-identifier hs-type">getLocalMethods'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span id="getLocalMethods%27"><span class="annot"><span class="annottext">getLocalMethods' :: Semantic (Map Name MethodDecl)
</span><a href="Semantic.html#getLocalMethods%27"><span class="hs-identifier hs-var hs-var">getLocalMethods'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679204357"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204357"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204357"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Map Name MethodDecl)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Map Name MethodDecl)
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic (Map Name MethodDecl))
-&gt; Name -&gt; Semantic (Map Name MethodDecl)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
</span><span class="hs-string">&quot;No method table for scope &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name) -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204357"><span class="hs-identifier hs-var">localST</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204358"><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204358"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl -&gt; Semantic (Map Name MethodDecl)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204358"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="annot"><a href="Semantic.html#updateSymbolTable"><span class="hs-identifier hs-type">updateSymbolTable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span id="updateSymbolTable"><span class="annot"><span class="annottext">updateSymbolTable :: SymbolTable -&gt; Semantic ()
</span><a href="Semantic.html#updateSymbolTable"><span class="hs-identifier hs-var hs-var">updateSymbolTable</span></a></span></span><span> </span><span id="local-6989586621679204360"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204360"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-199"></span><span>  </span><span id="local-6989586621679204361"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204361"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SemanticState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-comment">-- ensure the symbol table is present, otherwise throw an exception</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span class="hs-cpp">
  #symbolTables .= Map.insert (currentScopeID state) t (state ^. #symbolTables)
</span><span>
</span><span id="line-204"></span><span class="annot"><a href="Semantic.html#getMethodSignature"><span class="hs-identifier hs-type">getMethodSignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span id="getMethodSignature"><span class="annot"><span class="annottext">getMethodSignature :: Semantic (Maybe MethodSig)
</span><a href="Semantic.html#getMethodSignature"><span class="hs-identifier hs-var hs-var">getMethodSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe MethodSig
</span><a href="#local-6989586621679204364"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolTable -&gt; Maybe MethodSig)
-&gt; Semantic SymbolTable -&gt; Semantic (Maybe MethodSig)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>    </span><span class="annot"><a href="#local-6989586621679204364"><span class="hs-identifier hs-type">lookup</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span>
</span><span id="line-208"></span><span>    </span><span id="local-6989586621679204364"><span class="annot"><span class="annottext">lookup :: SymbolTable -&gt; Maybe MethodSig
</span><a href="#local-6989586621679204364"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#RootBlock"><span class="hs-identifier hs-var">RootBlock</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><a href="#local-6989586621679204364"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#MethodBlock"><span class="hs-identifier hs-var">MethodBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:methodSig:SymbolTable :: SymbolTable -&gt; Maybe MethodSig
</span><a href="Semantic.html#%24sel%3AmethodSig%3ASymbolTable"><span class="hs-identifier hs-var">methodSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204365"><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204365"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204365"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="#local-6989586621679204364"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:parent:SymbolTable :: SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204366"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204366"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe MethodSig
</span><a href="#local-6989586621679204364"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204366"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><a href="Semantic.html#getMethodSignature%27"><span class="hs-identifier hs-type">getMethodSignature'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span>
</span><span id="line-213"></span><span id="getMethodSignature%27"><span class="annot"><span class="annottext">getMethodSignature' :: Semantic MethodSig
</span><a href="Semantic.html#getMethodSignature%27"><span class="hs-identifier hs-var hs-var">getMethodSignature'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-214"></span><span>  </span><span id="local-6989586621679204368"><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204368"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe MethodSig)
</span><a href="Semantic.html#getMethodSignature"><span class="hs-identifier hs-var">getMethodSignature</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204368"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-216"></span><span>    </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic MethodSig
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Cannot find signature for current function!&quot;</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204369"><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204369"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MethodSig -&gt; Semantic MethodSig
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204369"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Semantic.html#enterScope"><span class="hs-identifier hs-type">enterScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#BlockType"><span class="hs-identifier hs-type">BlockType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span>
</span><span id="line-220"></span><span id="enterScope"><span class="annot"><span class="annottext">enterScope :: BlockType -&gt; Maybe MethodSig -&gt; Semantic ScopeID
</span><a href="Semantic.html#enterScope"><span class="hs-identifier hs-var hs-var">enterScope</span></a></span></span><span> </span><span id="local-6989586621679204371"><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204371"><span class="hs-identifier hs-var">blockType</span></a></span></span><span> </span><span id="local-6989586621679204372"><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204372"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-221"></span><span>  </span><span id="local-6989586621679204373"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204373"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SemanticState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679204374"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204374"><span class="hs-identifier hs-var">parentST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var">getSymbolTable</span></a></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204375"><span class="annot"><span class="annottext">nextID :: ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var hs-var">nextID</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AnextScopeID%3ASemanticState"><span class="hs-identifier hs-var">nextScopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204373"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span id="local-6989586621679204376"><span class="annot"><span class="annottext">args :: Maybe (Map Name Argument)
</span><a href="#local-6989586621679204376"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204372"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
-&gt; (MethodSig -&gt; Map Name Argument) -&gt; Maybe (Map Name Argument)
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679204377"><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204377"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Name, Argument)] -&gt; Map Name Argument
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(Name, Argument)] -&gt; Map Name Argument)
-&gt; [(Name, Argument)] -&gt; Map Name Argument
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204377"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">MethodSig -&gt; Getting [Argument] MethodSig [Argument] -&gt; [Argument]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Argument] MethodSig [Argument]
</span><span class="">#args</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; (Argument -&gt; (Name, Argument)) -&gt; [(Name, Argument)]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679204378"><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679204378"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679204378"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Argument -&gt; Getting Name Argument Name -&gt; Name
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Name Argument Name
</span><span class="">#name</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Argument
</span><a href="#local-6989586621679204378"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621679204379"><span class="annot"><span class="annottext">localST :: SymbolTable
</span><a href="#local-6989586621679204379"><span class="hs-identifier hs-var hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-226"></span><span>        </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span>
</span><span id="line-227"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:scopeID:SymbolTable :: ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var">nextID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>            </span><span class="annot"><span class="annottext">$sel:parent:SymbolTable :: Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204374"><span class="hs-identifier hs-var">parentST</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-229"></span><span>            </span><span class="annot"><span class="annottext">$sel:variableSymbols:SymbolTable :: Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name FieldDecl
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-230"></span><span>            </span><span class="annot"><span class="annottext">$sel:importSymbols:SymbolTable :: Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var">importSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Name ImportDecl)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-231"></span><span>            </span><span class="annot"><span class="annottext">$sel:methodSymbols:SymbolTable :: Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Name MethodDecl)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>            </span><span class="annot"><span class="annottext">$sel:arguments:SymbolTable :: Maybe (Map Name Argument)
</span><a href="Semantic.html#%24sel%3Aarguments%3ASymbolTable"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (Map Name Argument)
</span><a href="#local-6989586621679204376"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>            </span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204371"><span class="hs-identifier hs-var">blockType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>            </span><span class="annot"><span class="annottext">$sel:methodSig:SymbolTable :: Maybe MethodSig
</span><a href="Semantic.html#%24sel%3AmethodSig%3ASymbolTable"><span class="hs-identifier hs-var">methodSig</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204372"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><span class="annottext">SemanticState -&gt; Semantic ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(SemanticState -&gt; Semantic ()) -&gt; SemanticState -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-237"></span><span>    </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204373"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:nextScopeID:SemanticState :: ScopeID
</span><a href="Semantic.html#%24sel%3AnextScopeID%3ASemanticState"><span class="hs-identifier hs-var">nextScopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var">nextID</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; ScopeID
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span>
</span><span id="line-239"></span><span>        </span><span class="annot"><span class="annottext">$sel:currentScopeID:SemanticState :: ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var">nextID</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-240"></span><span>        </span><span class="annot"><span class="annottext">$sel:symbolTables:SemanticState :: Map ScopeID SymbolTable
</span><a href="Semantic.html#%24sel%3AsymbolTables%3ASemanticState"><span class="hs-identifier hs-var">symbolTables</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScopeID
-&gt; SymbolTable
-&gt; Map ScopeID SymbolTable
-&gt; Map ScopeID SymbolTable
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var">nextID</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204379"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="annot"><span class="annottext">(Map ScopeID SymbolTable -&gt; Map ScopeID SymbolTable)
-&gt; Map ScopeID SymbolTable -&gt; Map ScopeID SymbolTable
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204373"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
-&gt; Getting
     (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
-&gt; Map ScopeID SymbolTable
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Map ScopeID SymbolTable) SemanticState (Map ScopeID SymbolTable)
</span><span class="">#symbolTables</span></span><span>
</span><span id="line-241"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">ScopeID -&gt; Semantic ScopeID
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204375"><span class="hs-identifier hs-var">nextID</span></a></span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="annot"><a href="Semantic.html#exitScope"><span class="hs-identifier hs-type">exitScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span id="exitScope"><span class="annot"><span class="annottext">exitScope :: Semantic ()
</span><a href="Semantic.html#exitScope"><span class="hs-identifier hs-var hs-var">exitScope</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679204382"><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204382"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SemanticState
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-247"></span><span>  </span><span id="local-6989586621679204383"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204383"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var">getSymbolTable</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204383"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-251"></span><span>        </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
</span><span class="hs-string">&quot;No symbol table is associated with scope(&quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name) -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;)!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(ScopeID -&gt; Name) -&gt; ScopeID -&gt; Name
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-252"></span><span>          </span><span class="annot"><span class="annottext">SemanticState -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204382"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204384"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204384"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204384"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-255"></span><span>        </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-256"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Cannot exit root scope!&quot;</span></span><span>
</span><span id="line-257"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204385"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204385"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-258"></span><span>          </span><span class="annot"><span class="annottext">SemanticState -&gt; Semantic ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">(SemanticState -&gt; Semantic ()) -&gt; SemanticState -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SemanticState
</span><a href="#local-6989586621679204382"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:currentScopeID:SemanticState :: ScopeID
</span><a href="Semantic.html#%24sel%3AcurrentScopeID%3ASemanticState"><span class="hs-identifier hs-var">currentScopeID</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; ScopeID
</span><a href="Semantic.html#%24sel%3AscopeID%3ASymbolTable"><span class="hs-identifier hs-var">scopeID</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204385"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- Convert the parser tree into an AST</span><span>
</span><span id="line-262"></span><span class="hs-comment">-- Generate symbol tables at the same time.</span><span>
</span><span id="line-263"></span><span class="hs-comment">-- Also detects semantic errors.</span><span>
</span><span id="line-264"></span><span class="hs-comment">----------------------------------------------------------------------</span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">{-
Semantic rules to be checked, this will be referenced as Semantic[n]in comments below.
1. Identifier duplication.
2. Identifier should be declared before used.
3. Check for method &quot;main&quot;. Also check the parameters and return type.
4. Array length should be greater than 0.
5. Method call has matching type and number of arguments.
6. Method must return something if used in expressions.
7. String literals and array variables may not be used as args to non-import methods.
8. Method declared without a return type shall return nothing.
9. Method return type should match declared type.
10. id used as location should name a variable or parameter.
11. Method should be declared or imported before used.
12. Array location must refer to an array varaible, also the index expression must be of type int.
13. Argument of len operator must be an array.
14. The expression of 'if' and 'when', as well as the second expression of 'for' must have type 'bool'.
15. In a conditional expression (?:):
    The first expression must have type bool.
    The alternatives must have the same type.
16. The operands of the unary negative operator, arithmetic ops and relational ops must have type int.
17. The operands of equal ops must have the same type.
18. The operands of the logical not op and conditional op must have type bool.
19. The location and expression in an assignment must have the same type.
20. The location and expression in an incremental assignment must have type int.
21. All break and continue statment must be within a for or while loop.
22. All int literals must be in the range of -9223372036854775808 &#8804; x &#8804; 9223372036854775807
(64 bits).
-}</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span class="hs-comment">{-
  Helper functions to manipulate symbol tables.
-}</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">{- Varaible lookup. -}</span><span>
</span><span id="line-300"></span><span>
</span><span id="line-301"></span><span class="annot"><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier hs-type">lookupLocalVariableFromST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span id="lookupLocalVariableFromST"><span class="annot"><span class="annottext">lookupLocalVariableFromST :: Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier hs-var hs-var">lookupLocalVariableFromST</span></a></span></span><span> </span><span id="local-6989586621679204386"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204386"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204387"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204387"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204388"><span class="annot"><span class="annottext">f :: Maybe FieldDecl
</span><a href="#local-6989586621679204388"><span class="hs-identifier hs-var hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe FieldDecl
</span><a href="#local-6989586621679204389"><span class="hs-identifier hs-var">lookupLocalFieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204386"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204387"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-304"></span><span>      </span><span id="local-6989586621679204390"><span class="annot"><span class="annottext">a :: Maybe Argument
</span><a href="#local-6989586621679204390"><span class="hs-identifier hs-var hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe Argument
</span><a href="#local-6989586621679204391"><span class="hs-identifier hs-var">lookupArgument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204386"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204387"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-305"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDecl -&gt; Either Argument FieldDecl
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(FieldDecl -&gt; Either Argument FieldDecl)
-&gt; Maybe FieldDecl -&gt; Maybe (Either Argument FieldDecl)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe FieldDecl
</span><a href="#local-6989586621679204388"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
-&gt; Maybe (Either Argument FieldDecl)
-&gt; Maybe (Either Argument FieldDecl)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Argument -&gt; Either Argument FieldDecl
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(Argument -&gt; Either Argument FieldDecl)
-&gt; Maybe Argument -&gt; Maybe (Either Argument FieldDecl)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Argument
</span><a href="#local-6989586621679204390"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-307"></span><span>    </span><span id="local-6989586621679204389"><span class="annot"><span class="annottext">lookupLocalFieldDecl :: Name -&gt; SymbolTable -&gt; Maybe FieldDecl
</span><a href="#local-6989586621679204389"><span class="hs-identifier hs-var hs-var">lookupLocalFieldDecl</span></a></span></span><span> </span><span id="local-6989586621679204393"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204393"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204394"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204394"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name FieldDecl -&gt; Maybe FieldDecl
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204393"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Map Name FieldDecl -&gt; Maybe FieldDecl)
-&gt; Map Name FieldDecl -&gt; Maybe FieldDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204394"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-308"></span><span>    </span><span id="local-6989586621679204391"><span class="annot"><span class="annottext">lookupArgument :: Name -&gt; SymbolTable -&gt; Maybe Argument
</span><a href="#local-6989586621679204391"><span class="hs-identifier hs-var hs-var">lookupArgument</span></a></span></span><span> </span><span id="local-6989586621679204397"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204397"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204398"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204398"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name Argument)
</span><a href="Semantic.html#%24sel%3Aarguments%3ASymbolTable"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204398"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Map Name Argument)
-&gt; (Map Name Argument -&gt; Maybe Argument) -&gt; Maybe Argument
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name Argument -&gt; Maybe Argument
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204397"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="annot"><a href="Semantic.html#lookupVariable"><span class="hs-identifier hs-type">lookupVariable</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span id="lookupVariable"><span class="annot"><span class="annottext">lookupVariable :: Name -&gt; Semantic (Maybe (Either Argument FieldDecl))
</span><a href="Semantic.html#lookupVariable"><span class="hs-identifier hs-var hs-var">lookupVariable</span></a></span></span><span> </span><span id="local-6989586621679204400"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204400"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679204401"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204401"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var">getSymbolTable</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
-&gt; Semantic (Maybe (Either Argument FieldDecl))
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either Argument FieldDecl)
 -&gt; Semantic (Maybe (Either Argument FieldDecl)))
-&gt; Maybe (Either Argument FieldDecl)
-&gt; Semantic (Maybe (Either Argument FieldDecl))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204401"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
-&gt; (SymbolTable -&gt; Maybe (Either Argument FieldDecl))
-&gt; Maybe (Either Argument FieldDecl)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="#local-6989586621679204402"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204400"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-315"></span><span>    </span><span id="local-6989586621679204402"><span class="annot"><span class="annottext">lookup :: Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="#local-6989586621679204402"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679204405"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204405"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204406"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204406"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier hs-var">lookupLocalVariableFromST</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204405"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204406"><span class="hs-identifier hs-var">st'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>        </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
-&gt; Maybe (Either Argument FieldDecl)
-&gt; Maybe (Either Argument FieldDecl)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204406"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
-&gt; (SymbolTable -&gt; Maybe (Either Argument FieldDecl))
-&gt; Maybe (Either Argument FieldDecl)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="#local-6989586621679204402"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204405"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span class="annot"><a href="Semantic.html#lookupVariable%27"><span class="hs-identifier hs-type">lookupVariable'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span id="lookupVariable%27"><span class="annot"><span class="annottext">lookupVariable' :: Name -&gt; Semantic (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupVariable%27"><span class="hs-identifier hs-var hs-var">lookupVariable'</span></a></span></span><span> </span><span id="local-6989586621679204408"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204408"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-321"></span><span>  </span><span id="local-6989586621679204409"><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
</span><a href="#local-6989586621679204409"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Maybe (Either Argument FieldDecl))
</span><a href="Semantic.html#lookupVariable"><span class="hs-identifier hs-var">lookupVariable</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204408"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
</span><a href="#local-6989586621679204409"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either Argument FieldDecl)
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic (Either Argument FieldDecl))
-&gt; Name -&gt; Semantic (Either Argument FieldDecl)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Varaible &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; not defined&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204408"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204411"><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204411"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl -&gt; Semantic (Either Argument FieldDecl)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204411"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="annot"><a href="Semantic.html#lookupVariableScope"><span class="hs-identifier hs-type">lookupVariableScope</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span id="lookupVariableScope"><span class="annot"><span class="annottext">lookupVariableScope :: Name -&gt; Semantic (Maybe ScopeID)
</span><a href="Semantic.html#lookupVariableScope"><span class="hs-identifier hs-var hs-var">lookupVariableScope</span></a></span></span><span> </span><span id="local-6989586621679204413"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204413"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679204414"><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204414"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe SymbolTable)
</span><a href="Semantic.html#getSymbolTable"><span class="hs-identifier hs-var">getSymbolTable</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="annot"><span class="annottext">Maybe ScopeID -&gt; Semantic (Maybe ScopeID)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ScopeID -&gt; Semantic (Maybe ScopeID))
-&gt; Maybe ScopeID -&gt; Semantic (Maybe ScopeID)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><a href="#local-6989586621679204414"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
-&gt; (SymbolTable -&gt; Maybe ScopeID) -&gt; Maybe ScopeID
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe ScopeID
</span><a href="#local-6989586621679204415"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204413"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-331"></span><span>    </span><span id="local-6989586621679204415"><span class="annot"><span class="annottext">lookup :: Name -&gt; SymbolTable -&gt; Maybe ScopeID
</span><a href="#local-6989586621679204415"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679204446"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204446"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204447"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204447"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-332"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier hs-var">lookupLocalVariableFromST</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204446"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204447"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl)
-&gt; (Either Argument FieldDecl -&gt; ScopeID) -&gt; Maybe ScopeID
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204447"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Getting ScopeID SymbolTable ScopeID -&gt; ScopeID
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting ScopeID SymbolTable ScopeID
</span><span class="">#scopeID</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><span class="annottext">Maybe ScopeID -&gt; Maybe ScopeID -&gt; Maybe ScopeID
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204447"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
-&gt; (SymbolTable -&gt; Maybe ScopeID) -&gt; Maybe ScopeID
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe ScopeID
</span><a href="#local-6989586621679204415"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204446"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span class="annot"><a href="Semantic.html#lookupVariableScope%27"><span class="hs-identifier hs-type">lookupVariableScope'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="Types.html#ScopeID"><span class="hs-identifier hs-type">ScopeID</span></a></span><span>
</span><span id="line-336"></span><span id="lookupVariableScope%27"><span class="annot"><span class="annottext">lookupVariableScope' :: Name -&gt; Semantic ScopeID
</span><a href="Semantic.html#lookupVariableScope%27"><span class="hs-identifier hs-var hs-var">lookupVariableScope'</span></a></span></span><span> </span><span id="local-6989586621679204449"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204449"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679204450"><span class="annot"><span class="annottext">Maybe ScopeID
</span><a href="#local-6989586621679204450"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Maybe ScopeID)
</span><a href="Semantic.html#lookupVariableScope"><span class="hs-identifier hs-var">lookupVariableScope</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204449"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe ScopeID
</span><a href="#local-6989586621679204450"><span class="hs-identifier hs-var">sid</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><span class="annottext">Maybe ScopeID
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ScopeID
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ScopeID) -&gt; Name -&gt; Semantic ScopeID
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Varaible &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; not defined&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204449"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204451"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204451"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; Semantic ScopeID
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204451"><span class="hs-identifier hs-var">sid</span></a></span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span class="hs-comment">{- Method lookup. -}</span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><a href="Semantic.html#lookupLocalMethodFromST"><span class="hs-identifier hs-type">lookupLocalMethodFromST</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span id="lookupLocalMethodFromST"><span class="annot"><span class="annottext">lookupLocalMethodFromST :: Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="Semantic.html#lookupLocalMethodFromST"><span class="hs-identifier hs-var hs-var">lookupLocalMethodFromST</span></a></span></span><span> </span><span id="local-6989586621679204452"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204452"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204453"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204453"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204454"><span class="annot"><span class="annottext">method :: Maybe MethodDecl
</span><a href="#local-6989586621679204454"><span class="hs-identifier hs-var hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-347"></span><span>        </span><span id="local-6989586621679204455"><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204455"><span class="hs-identifier hs-var">methodTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204453"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Map Name MethodDecl -&gt; Maybe MethodDecl
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204452"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204455"><span class="hs-identifier hs-var">methodTable</span></a></span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621679204456"><span class="annot"><span class="annottext">import' :: Maybe ImportDecl
</span><a href="#local-6989586621679204456"><span class="hs-identifier hs-var hs-var">import'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-350"></span><span>        </span><span id="local-6989586621679204457"><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204457"><span class="hs-identifier hs-var">importTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var">importSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204453"><span class="hs-identifier hs-var">table</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Map Name ImportDecl -&gt; Maybe ImportDecl
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204452"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204457"><span class="hs-identifier hs-var">importTable</span></a></span><span>
</span><span id="line-352"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodDecl -&gt; Either ImportDecl MethodDecl
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(MethodDecl -&gt; Either ImportDecl MethodDecl)
-&gt; Maybe MethodDecl -&gt; Maybe (Either ImportDecl MethodDecl)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe MethodDecl
</span><a href="#local-6989586621679204454"><span class="hs-identifier hs-var">method</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
-&gt; Maybe (Either ImportDecl MethodDecl)
-&gt; Maybe (Either ImportDecl MethodDecl)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ImportDecl -&gt; Either ImportDecl MethodDecl
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ImportDecl -&gt; Either ImportDecl MethodDecl)
-&gt; Maybe ImportDecl -&gt; Maybe (Either ImportDecl MethodDecl)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe ImportDecl
</span><a href="#local-6989586621679204456"><span class="hs-identifier hs-var">import'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="annot"><a href="Semantic.html#lookupMethod"><span class="hs-identifier hs-type">lookupMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span id="lookupMethod"><span class="annot"><span class="annottext">lookupMethod :: Name -&gt; Semantic (Maybe (Either ImportDecl MethodDecl))
</span><a href="Semantic.html#lookupMethod"><span class="hs-identifier hs-var hs-var">lookupMethod</span></a></span></span><span> </span><span id="local-6989586621679204459"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204459"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-356"></span><span>  </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204460"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204459"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl))
-&gt; Semantic SymbolTable
-&gt; Semantic (Maybe (Either ImportDecl MethodDecl))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-358"></span><span>    </span><span id="local-6989586621679204460"><span class="annot"><span class="annottext">lookup :: Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204460"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span id="local-6989586621679204463"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204463"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679204464"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204464"><span class="hs-identifier hs-var">table</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="Semantic.html#lookupLocalMethodFromST"><span class="hs-identifier hs-var">lookupLocalMethodFromST</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204463"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204464"><span class="hs-identifier hs-var">table</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
-&gt; Maybe (Either ImportDecl MethodDecl)
-&gt; Maybe (Either ImportDecl MethodDecl)
forall a. Maybe a -&gt; Maybe a -&gt; Maybe a
forall (f :: * -&gt; *) a. Alternative f =&gt; f a -&gt; f a -&gt; f a
</span><span class="hs-operator hs-var">&lt;|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204464"><span class="hs-identifier hs-var">table</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
-&gt; (SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl))
-&gt; Maybe (Either ImportDecl MethodDecl)
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204460"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204463"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="annot"><a href="Semantic.html#lookupMethod%27"><span class="hs-identifier hs-type">lookupMethod'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Types.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span id="lookupMethod%27"><span class="annot"><span class="annottext">lookupMethod' :: Name -&gt; Semantic (Either ImportDecl MethodDecl)
</span><a href="Semantic.html#lookupMethod%27"><span class="hs-identifier hs-var hs-var">lookupMethod'</span></a></span></span><span> </span><span id="local-6989586621679204466"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204466"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-362"></span><span>  </span><span id="local-6989586621679204467"><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204467"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Maybe (Either ImportDecl MethodDecl))
</span><a href="Semantic.html#lookupMethod"><span class="hs-identifier hs-var">lookupMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204466"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204467"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either ImportDecl MethodDecl)
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic (Either ImportDecl MethodDecl))
-&gt; Name -&gt; Semantic (Either ImportDecl MethodDecl)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; not found&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204466"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204468"><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204468"><span class="hs-identifier hs-var">m'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
-&gt; Semantic (Either ImportDecl MethodDecl)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204468"><span class="hs-identifier hs-var">m'</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-comment">{- Add variables and methods -}</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="annot"><a href="Semantic.html#addVariableDef"><span class="hs-identifier hs-type">addVariableDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span id="addVariableDef"><span class="annot"><span class="annottext">addVariableDef :: FieldDecl -&gt; Semantic ()
</span><a href="Semantic.html#addVariableDef"><span class="hs-identifier hs-var hs-var">addVariableDef</span></a></span></span><span> </span><span id="local-6989586621679204470"><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204470"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-371"></span><span>  </span><span id="local-6989586621679204471"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204471"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span class="hs-comment">-- Semantic[1]</span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204472"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679204472"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting Name FieldDecl Name -&gt; FieldDecl -&gt; Name
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Name FieldDecl Name
</span><span class="">#name</span></span><span> </span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204470"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either Argument FieldDecl) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupLocalVariableFromST"><span class="hs-identifier hs-var">lookupLocalVariableFromST</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204472"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204471"><span class="hs-identifier hs-var">localST</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;duplicate definition for variable &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204472"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204474"><span class="annot"><span class="annottext">variableSymbols' :: Map Name FieldDecl
</span><a href="#local-6989586621679204474"><span class="hs-identifier hs-var hs-var">variableSymbols'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; FieldDecl -&gt; Map Name FieldDecl -&gt; Map Name FieldDecl
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204472"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204470"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SymbolTable -&gt; Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204471"><span class="hs-identifier hs-var">localST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>      </span><span id="local-6989586621679204475"><span class="annot"><span class="annottext">newST :: SymbolTable
</span><a href="#local-6989586621679204475"><span class="hs-identifier hs-var hs-var">newST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204471"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:variableSymbols:SymbolTable :: Map Name FieldDecl
</span><a href="Semantic.html#%24sel%3AvariableSymbols%3ASymbolTable"><span class="hs-identifier hs-var">variableSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name FieldDecl
</span><a href="#local-6989586621679204474"><span class="hs-identifier hs-var">variableSymbols'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-comment">-- Semantic[4]</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204470"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204478"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204478"><span class="hs-identifier hs-var">sz</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204478"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-383"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Invalid size of array &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204472"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-384"></span><span>    </span><span class="annot"><span class="annottext">FieldDecl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable -&gt; Semantic ()
</span><a href="Semantic.html#updateSymbolTable"><span class="hs-identifier hs-var">updateSymbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204475"><span class="hs-identifier hs-var">newST</span></a></span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="annot"><a href="Semantic.html#addImportDef"><span class="hs-identifier hs-type">addImportDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span id="addImportDef"><span class="annot"><span class="annottext">addImportDef :: ImportDecl -&gt; Semantic ()
</span><a href="Semantic.html#addImportDef"><span class="hs-identifier hs-var hs-var">addImportDef</span></a></span></span><span> </span><span id="local-6989586621679204481"><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621679204481"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621679204482"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204482"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621679204483"><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204483"><span class="hs-identifier hs-var">importTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Map Name ImportDecl)
</span><a href="Semantic.html#getLocalImports%27"><span class="hs-identifier hs-var">getLocalImports'</span></a></span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-comment">-- Semantic[1]</span><span>
</span><span id="line-392"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204484"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679204484"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Getting Name ImportDecl Name -&gt; ImportDecl -&gt; Name
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting Name ImportDecl Name
</span><span class="">#name</span></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621679204481"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-393"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ImportDecl -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ImportDecl -&gt; Bool) -&gt; Maybe ImportDecl -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Map Name ImportDecl -&gt; Maybe ImportDecl
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204484"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204483"><span class="hs-identifier hs-var">importTable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;duplicate import &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204484"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204485"><span class="annot"><span class="annottext">importSymbols' :: Map Name ImportDecl
</span><a href="#local-6989586621679204485"><span class="hs-identifier hs-var hs-var">importSymbols'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; ImportDecl -&gt; Map Name ImportDecl -&gt; Map Name ImportDecl
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204484"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621679204481"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204483"><span class="hs-identifier hs-var">importTable</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span id="local-6989586621679204486"><span class="annot"><span class="annottext">newST :: SymbolTable
</span><a href="#local-6989586621679204486"><span class="hs-identifier hs-var hs-var">newST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204482"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:importSymbols:SymbolTable :: Maybe (Map Name ImportDecl)
</span><a href="Semantic.html#%24sel%3AimportSymbols%3ASymbolTable"><span class="hs-identifier hs-var">importSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl -&gt; Maybe (Map Name ImportDecl)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Map Name ImportDecl
</span><a href="#local-6989586621679204485"><span class="hs-identifier hs-var">importSymbols'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-398"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable -&gt; Semantic ()
</span><a href="Semantic.html#updateSymbolTable"><span class="hs-identifier hs-var">updateSymbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204486"><span class="hs-identifier hs-var">newST</span></a></span><span>
</span><span id="line-399"></span><span>
</span><span id="line-400"></span><span class="annot"><a href="Semantic.html#addMethodDef"><span class="hs-identifier hs-type">addMethodDef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span id="addMethodDef"><span class="annot"><span class="annottext">addMethodDef :: MethodDecl -&gt; Semantic ()
</span><a href="Semantic.html#addMethodDef"><span class="hs-identifier hs-var hs-var">addMethodDef</span></a></span></span><span> </span><span id="local-6989586621679204488"><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204488"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-402"></span><span>  </span><span id="local-6989586621679204489"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204489"><span class="hs-identifier hs-var">localST</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-403"></span><span>  </span><span id="local-6989586621679204490"><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204490"><span class="hs-identifier hs-var">methodTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Map Name MethodDecl)
</span><a href="Semantic.html#getLocalMethods%27"><span class="hs-identifier hs-var">getLocalMethods'</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-comment">-- Semantic[1]</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204491"><span class="annot"><span class="annottext">nm :: Name
</span><a href="#local-6989586621679204491"><span class="hs-identifier hs-var hs-var">nm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204488"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl -&gt; Getting Name MethodDecl Name -&gt; Name
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MethodSig -&gt; Const Name MethodSig)
-&gt; MethodDecl -&gt; Const Name MethodDecl
</span><span class="">#sig</span></span><span> </span><span class="annot"><span class="annottext">((MethodSig -&gt; Const Name MethodSig)
 -&gt; MethodDecl -&gt; Const Name MethodDecl)
-&gt; ((Name -&gt; Const Name Name) -&gt; MethodSig -&gt; Const Name MethodSig)
-&gt; Getting Name MethodDecl Name
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Const Name Name) -&gt; MethodSig -&gt; Const Name MethodSig
</span><span class="">#name</span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isJust</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Either ImportDecl MethodDecl) -&gt; Bool)
-&gt; Maybe (Either ImportDecl MethodDecl) -&gt; Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; SymbolTable -&gt; Maybe (Either ImportDecl MethodDecl)
</span><a href="Semantic.html#lookupLocalMethodFromST"><span class="hs-identifier hs-var">lookupLocalMethodFromST</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204491"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204489"><span class="hs-identifier hs-var">localST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;duplicate definition for method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204491"><span class="hs-identifier hs-var">nm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204493"><span class="annot"><span class="annottext">methodSymbols' :: Map Name MethodDecl
</span><a href="#local-6989586621679204493"><span class="hs-identifier hs-var hs-var">methodSymbols'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; MethodDecl -&gt; Map Name MethodDecl -&gt; Map Name MethodDecl
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204491"><span class="hs-identifier hs-var">nm</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204488"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204490"><span class="hs-identifier hs-var">methodTable</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span id="local-6989586621679204494"><span class="annot"><span class="annottext">newST :: SymbolTable
</span><a href="#local-6989586621679204494"><span class="hs-identifier hs-var hs-var">newST</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204489"><span class="hs-identifier hs-var">localST</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:methodSymbols:SymbolTable :: Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl -&gt; Maybe (Map Name MethodDecl)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204493"><span class="hs-identifier hs-var">methodSymbols'</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-411"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable -&gt; Semantic ()
</span><a href="Semantic.html#updateSymbolTable"><span class="hs-identifier hs-var">updateSymbolTable</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204494"><span class="hs-identifier hs-var">newST</span></a></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="hs-comment">{-
  Helper methods to do semantic checks.
-}</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- Semantic[8] and Semantic[9]</span><span>
</span><span id="line-418"></span><span class="annot"><a href="Semantic.html#checkReturnType"><span class="hs-identifier hs-type">checkReturnType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span id="checkReturnType"><span class="annot"><span class="annottext">checkReturnType :: Maybe Expr -&gt; Semantic ()
</span><a href="Semantic.html#checkReturnType"><span class="hs-identifier hs-var hs-var">checkReturnType</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span id="local-6989586621679204497"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204497"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679204498"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204498"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic MethodSig
</span><a href="Semantic.html#getMethodSignature%27"><span class="hs-identifier hs-var">getMethodSignature'</span></a></span><span>
</span><span id="line-421"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204498"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204499"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204499"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Type -&gt; Name) -&gt; Name -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Type -&gt; Name) (Name -&gt; Type -&gt; Name)
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Type -&gt; Name) (Name -&gt; Type -&gt; Name)
-&gt; Format Name (Name -&gt; Type -&gt; Name)
-&gt; Format Name (Name -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Name -&gt; Type -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Name -&gt; Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Name -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot; expects return type of &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204497"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204499"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span class="annot"><a href="Semantic.html#checkReturnType"><span class="hs-identifier hs-var">checkReturnType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204502"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204502"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span id="local-6989586621679204503"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204503"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679204504"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204504"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic MethodSig
</span><a href="Semantic.html#getMethodSignature%27"><span class="hs-identifier hs-var">getMethodSignature'</span></a></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204504"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; expects no return value!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204503"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679204505"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204505"><span class="hs-identifier hs-var">t</span></a></span></span><span>
</span><span id="line-429"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204505"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type -&gt; Maybe Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204504"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-431"></span><span>            </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
-&gt; Name -&gt; Maybe Type -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span>
</span><span id="line-432"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format
  (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
  (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
  (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe Type -&gt; Type -&gt; Name) (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Maybe Type -&gt; Type -&gt; Name) (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Name -&gt; Maybe Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Maybe Type -&gt; Type -&gt; Name) (Maybe Type -&gt; Type -&gt; Name)
</span><span class="hs-string">&quot; expects return type of &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Maybe Type -&gt; Type -&gt; Name) (Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Maybe Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Maybe Type -&gt; Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Maybe Type -&gt; Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name)
-&gt; Format Name (Maybe Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot;, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>              </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204503"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-434"></span><span>              </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204504"><span class="hs-identifier hs-var">tpe</span></a></span><span>
</span><span id="line-435"></span><span>              </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204502"><span class="hs-identifier hs-var">tpe'</span></a></span><span>
</span><span id="line-436"></span><span>    </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | Check if content of lit is a valid int64.</span><span>
</span><span id="line-439"></span><span class="hs-comment">-- lit should be striped of whitespace from both ends and contains only</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- numeric characters or the minus sign '-'.</span><span>
</span><span id="line-441"></span><span class="hs-comment">-- -9223372036854775808 &#8804; x &#8804; 9223372036854775807</span><span>
</span><span id="line-442"></span><span class="hs-comment">-- checks Semantic[22].</span><span>
</span><span id="line-443"></span><span class="annot"><a href="Semantic.html#checkInt64Literal"><span class="hs-identifier hs-type">checkInt64Literal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-444"></span><span id="checkInt64Literal"><span class="annot"><span class="annottext">checkInt64Literal :: Name -&gt; Semantic Int64
</span><a href="Semantic.html#checkInt64Literal"><span class="hs-identifier hs-var hs-var">checkInt64Literal</span></a></span></span><span> </span><span id="local-6989586621679204508"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204508"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-445"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204508"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Semantic () -&gt; Semantic ()) -&gt; Semantic () -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Cannot parse int literal from an empty token!&quot;</span></span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204510"><span class="annot"><span class="annottext">isNegative :: Bool
</span><a href="#local-6989586621679204510"><span class="hs-identifier hs-var hs-var">isNegative</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; Name -&gt; Char
Name -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204508"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'-'</span></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-comment">-- unless</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-comment">--   ( (isNegative &amp;&amp; (T.drop 1 lit) &lt;= &quot;9223372036854775808&quot;)</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-comment">--       || (not isNegative &amp;&amp; lit &lt;= &quot;9223372036854775807&quot;)</span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-comment">--   )</span><span>
</span><span id="line-452"></span><span>  </span><span class="hs-comment">--   throwSemanticException</span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-comment">--   $ printf &quot;Int literal %s is out of bound&quot; lit</span><span>
</span><span id="line-454"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Reader Int64
forall a. Integral a =&gt; Reader a
</span><span class="hs-identifier hs-var">T.decimal</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204508"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-455"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679204513"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204513"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Semantic Int64
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204513"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-456"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679204514"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679204514"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic Int64
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic Int64) -&gt; Name -&gt; Semantic Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (String -&gt; Name) -&gt; String -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (String -&gt; Name) (String -&gt; Name)
</span><span class="hs-string">&quot;cannot parse int literal &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (String -&gt; Name) (String -&gt; Name)
-&gt; Format Name (String -&gt; Name) -&gt; Format Name (String -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (String -&gt; Name)
forall r. Format r (String -&gt; r)
</span><span class="hs-identifier hs-var">string</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679204514"><span class="hs-identifier hs-var">msg</span></a></span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><a href="Semantic.html#checkBoolLiteral"><span class="hs-identifier hs-type">checkBoolLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-459"></span><span id="checkBoolLiteral"><span class="annot"><span class="annottext">checkBoolLiteral :: Name -&gt; Semantic Bool
</span><a href="Semantic.html#checkBoolLiteral"><span class="hs-identifier hs-var hs-var">checkBoolLiteral</span></a></span></span><span> </span><span id="local-6989586621679204517"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204517"><span class="hs-identifier hs-var">lit</span></a></span></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204517"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;true&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Semantic Bool
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204517"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;false&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Semantic Bool
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-463"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;error parsing bool literal from string &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204517"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-464"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Semantic Bool
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="annot"><a href="Semantic.html#checkCharLiteral"><span class="hs-identifier hs-type">checkCharLiteral</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-467"></span><span id="checkCharLiteral"><span class="annot"><span class="annottext">checkCharLiteral :: Name -&gt; Semantic Char
</span><a href="Semantic.html#checkCharLiteral"><span class="hs-identifier hs-var hs-var">checkCharLiteral</span></a></span></span><span> </span><span id="local-6989586621679204519"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204519"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-469"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ScopeID
</span><span class="hs-identifier hs-var">T.length</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204519"><span class="hs-identifier hs-var">lit</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Bool
</span><span class="hs-identifier hs-var">T.null</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204519"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;cannot parse char literal from string &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204519"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">Char -&gt; Semantic Char
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Semantic Char) -&gt; Char -&gt; Semantic Char
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Name -&gt; Char
Name -&gt; Char
</span><span class="hs-identifier hs-var">T.head</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204519"><span class="hs-identifier hs-var">lit</span></a></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><a href="Semantic.html#isInsideLoop"><span class="hs-identifier hs-type">isInsideLoop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-474"></span><span id="isInsideLoop"><span class="annot"><span class="annottext">isInsideLoop :: Semantic Bool
</span><a href="Semantic.html#isInsideLoop"><span class="hs-identifier hs-var hs-var">isInsideLoop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="annottext">SymbolTable -&gt; Bool
</span><a href="#local-6989586621679204524"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">(SymbolTable -&gt; Bool) -&gt; Semantic SymbolTable -&gt; Semantic Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getSymbolTable%27"><span class="hs-identifier hs-var">getSymbolTable'</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-477"></span><span>    </span><span id="local-6989586621679204524"><span class="annot"><span class="annottext">lookup :: SymbolTable -&gt; Bool
</span><a href="#local-6989586621679204524"><span class="hs-identifier hs-var hs-var">lookup</span></a></span></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#ForBlock"><span class="hs-identifier hs-var">ForBlock</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="#local-6989586621679204524"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#WhileBlock"><span class="hs-identifier hs-var">WhileBlock</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-479"></span><span>    </span><span class="annot"><a href="#local-6989586621679204524"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:parent:SymbolTable :: SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe SymbolTable
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-480"></span><span>    </span><span class="annot"><a href="#local-6989586621679204524"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><a href="Semantic.html#SymbolTable"><span class="hs-identifier hs-type">SymbolTable</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:blockType:SymbolTable :: SymbolTable -&gt; BlockType
</span><a href="Semantic.html#%24sel%3AblockType%3ASymbolTable"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:parent:SymbolTable :: SymbolTable -&gt; Maybe SymbolTable
</span><a href="Semantic.html#%24sel%3Aparent%3ASymbolTable"><span class="hs-identifier hs-var">parent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204525"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204525"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Bool
</span><a href="#local-6989586621679204524"><span class="hs-identifier hs-var">lookup</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204525"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">{-
  Methods to generate ir piece by piece.
-}</span><span>
</span><span id="line-485"></span><span>
</span><span id="line-486"></span><span class="annot"><a href="Semantic.html#irgenRoot"><span class="hs-identifier hs-type">irgenRoot</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Program"><span class="hs-identifier hs-type">P.Program</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#ASTRoot"><span class="hs-identifier hs-type">ASTRoot</span></a></span><span>
</span><span id="line-487"></span><span id="irgenRoot"><span class="annot"><span class="annottext">irgenRoot :: Program -&gt; Semantic ASTRoot
</span><a href="Semantic.html#irgenRoot"><span class="hs-identifier hs-var hs-var">irgenRoot</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#Program"><span class="hs-identifier hs-type">P.Program</span></a></span><span> </span><span id="local-6989586621679204527"><span class="annot"><span class="annottext">[Located ImportDecl]
</span><a href="#local-6989586621679204527"><span class="hs-identifier hs-var">imports</span></a></span></span><span> </span><span id="local-6989586621679204528"><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204528"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span id="local-6989586621679204529"><span class="annot"><span class="annottext">[Located MethodDecl]
</span><a href="#local-6989586621679204529"><span class="hs-identifier hs-var">methods</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-488"></span><span>  </span><span id="local-6989586621679204530"><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621679204530"><span class="hs-identifier hs-var">imports'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located ImportDecl] -&gt; Semantic [ImportDecl]
</span><a href="Semantic.html#irgenImports"><span class="hs-identifier hs-var">irgenImports</span></a></span><span> </span><span class="annot"><span class="annottext">[Located ImportDecl]
</span><a href="#local-6989586621679204527"><span class="hs-identifier hs-var">imports</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span id="local-6989586621679204532"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204532"><span class="hs-identifier hs-var">variables'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-var">irgenFieldDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204528"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-490"></span><span>  </span><span id="local-6989586621679204534"><span class="annot"><span class="annottext">[MethodDecl]
</span><a href="#local-6989586621679204534"><span class="hs-identifier hs-var">methods'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located MethodDecl] -&gt; Semantic [MethodDecl]
</span><a href="Semantic.html#irgenMethodDecls"><span class="hs-identifier hs-var">irgenMethodDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Located MethodDecl]
</span><a href="#local-6989586621679204529"><span class="hs-identifier hs-var">methods</span></a></span><span>
</span><span id="line-491"></span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-comment">-- check method &quot;main&quot;</span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-comment">-- Semantic[3]</span><span>
</span><span id="line-494"></span><span>  </span><span id="local-6989586621679204536"><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204536"><span class="hs-identifier hs-var">globalTable</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic SymbolTable
</span><a href="Semantic.html#getGlobalSymbolTable%27"><span class="hs-identifier hs-var">getGlobalSymbolTable'</span></a></span><span>
</span><span id="line-495"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204537"><span class="annot"><span class="annottext">main :: Maybe MethodDecl
</span><a href="#local-6989586621679204537"><span class="hs-identifier hs-var hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-496"></span><span>        </span><span id="local-6989586621679204538"><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204538"><span class="hs-identifier hs-var">methodSyms</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">SymbolTable -&gt; Maybe (Map Name MethodDecl)
</span><a href="Semantic.html#%24sel%3AmethodSymbols%3ASymbolTable"><span class="hs-identifier hs-var">methodSymbols</span></a></span><span> </span><span class="annot"><span class="annottext">SymbolTable
</span><a href="#local-6989586621679204536"><span class="hs-identifier hs-var">globalTable</span></a></span><span>
</span><span id="line-497"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Map Name MethodDecl -&gt; Maybe MethodDecl
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Map.lookup</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="Util.Constants.html#mainMethodName"><span class="hs-identifier hs-var">mainMethodName</span></a></span><span> </span><span class="annot"><span class="annottext">Map Name MethodDecl
</span><a href="#local-6989586621679204538"><span class="hs-identifier hs-var">methodSyms</span></a></span><span>
</span><span id="line-498"></span><span>  </span><span id="local-6989586621679204540"><span class="annot"><span class="annottext">Maybe MethodDecl
</span><a href="#local-6989586621679204540"><span class="hs-identifier hs-var">mainDecl</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Maybe MethodDecl -&gt; Semantic (Maybe MethodDecl)
forall {a}. Maybe a -&gt; Semantic (Maybe a)
</span><a href="#local-6989586621679204541"><span class="hs-identifier hs-var">checkMainExist</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodDecl
</span><a href="#local-6989586621679204537"><span class="hs-identifier hs-var">main</span></a></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MethodDecl
</span><a href="#local-6989586621679204540"><span class="hs-identifier hs-var">mainDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodDecl
-&gt; (MethodDecl -&gt; Maybe MethodSig) -&gt; Maybe MethodSig
forall a b. Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">MethodSig -&gt; Maybe MethodSig
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(MethodSig -&gt; Maybe MethodSig)
-&gt; (MethodDecl -&gt; MethodSig) -&gt; MethodDecl -&gt; Maybe MethodSig
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting MethodSig MethodDecl MethodSig -&gt; MethodDecl -&gt; MethodSig
forall s (m :: * -&gt; *) a. MonadReader s m =&gt; Getting a s a -&gt; m a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting MethodSig MethodDecl MethodSig
</span><span class="">#sig</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-500"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204542"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204542"><span class="hs-identifier hs-var">retType</span></a></span></span><span> </span><span id="local-6989586621679204543"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204543"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><span class="annottext">Maybe Type -&gt; Semantic ()
forall {a}. Show a =&gt; Maybe a -&gt; Semantic ()
</span><a href="#local-6989586621679204544"><span class="hs-identifier hs-var">checkMainRetType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204542"><span class="hs-identifier hs-var">retType</span></a></span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><span class="annottext">[Argument] -&gt; Semantic ()
forall {t :: * -&gt; *} {a}. Foldable t =&gt; t a -&gt; Semantic ()
</span><a href="#local-6989586621679204545"><span class="hs-identifier hs-var">checkMainArgsType</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204543"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-503"></span><span>    </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><span class="annottext">ASTRoot -&gt; Semantic ASTRoot
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(ASTRoot -&gt; Semantic ASTRoot) -&gt; ASTRoot -&gt; Semantic ASTRoot
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; [FieldDecl] -&gt; [MethodDecl] -&gt; ASTRoot
</span><a href="AST.html#ASTRoot"><span class="hs-identifier hs-var">ASTRoot</span></a></span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621679204530"><span class="hs-identifier hs-var">imports'</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204532"><span class="hs-identifier hs-var">variables'</span></a></span><span> </span><span class="annot"><span class="annottext">[MethodDecl]
</span><a href="#local-6989586621679204534"><span class="hs-identifier hs-var">methods'</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679204541"><span class="annot"><span class="annottext">checkMainExist :: Maybe a -&gt; Semantic (Maybe a)
</span><a href="#local-6989586621679204541"><span class="hs-identifier hs-var hs-var">checkMainExist</span></a></span></span><span> </span><span id="local-6989586621679204551"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679204551"><span class="hs-identifier hs-var">main</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679204551"><span class="hs-identifier hs-var">main</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-508"></span><span>        </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-509"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Method \&quot;main\&quot; not found!&quot;</span></span><span>
</span><span id="line-510"></span><span>          </span><span class="annot"><span class="annottext">Maybe a -&gt; Semantic (Maybe a)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-511"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204552"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679204552"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe a -&gt; Semantic (Maybe a)
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Maybe a -&gt; Semantic (Maybe a)) -&gt; Maybe a -&gt; Semantic (Maybe a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679204552"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-512"></span><span>    </span><span id="local-6989586621679204544"><span class="annot"><span class="annottext">checkMainRetType :: Maybe a -&gt; Semantic ()
</span><a href="#local-6989586621679204544"><span class="hs-identifier hs-var hs-var">checkMainRetType</span></a></span></span><span> </span><span id="local-6989586621679204560"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679204560"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679204560"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204561"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679204561"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-515"></span><span>        </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-516"></span><span>          </span><span class="annot"><span class="annottext">Format Name (a -&gt; Name) -&gt; a -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span>
</span><span id="line-517"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (a -&gt; Name) (a -&gt; Name)
</span><span class="hs-string">&quot;Method \&quot;main\&quot; should have return type of void, got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (a -&gt; Name) (a -&gt; Name)
-&gt; Format Name (a -&gt; Name) -&gt; Format Name (a -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (a -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (a -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (a -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-518"></span><span>            </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679204561"><span class="hs-identifier hs-var">tpe</span></a></span><span>
</span><span id="line-519"></span><span>    </span><span id="local-6989586621679204545"><span class="annot"><span class="annottext">checkMainArgsType :: t a -&gt; Semantic ()
</span><a href="#local-6989586621679204545"><span class="hs-identifier hs-var hs-var">checkMainArgsType</span></a></span></span><span> </span><span id="local-6989586621679204566"><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679204566"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-521"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Bool
forall a. t a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">t a
</span><a href="#local-6989586621679204566"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Method \&quot;main\&quot; should have no argument.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="annot"><a href="Semantic.html#irgenType"><span class="hs-identifier hs-type">irgenType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Type"><span class="hs-identifier hs-type">P.Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-525"></span><span id="irgenType"><span class="annot"><span class="annottext">irgenType :: Type -&gt; Type
</span><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var hs-var">irgenType</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.Tree.html#IntType"><span class="hs-identifier hs-var">P.IntType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span>
</span><span id="line-526"></span><span class="annot"><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var">irgenType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="Parser.Tree.html#BoolType"><span class="hs-identifier hs-var">P.BoolType</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="annot"><a href="Semantic.html#irgenImports"><span class="hs-identifier hs-type">irgenImports</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#ImportDecl"><span class="hs-identifier hs-type">P.ImportDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#ImportDecl"><span class="hs-identifier hs-type">ImportDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-529"></span><span id="irgenImports"><span class="annot"><span class="annottext">irgenImports :: [Located ImportDecl] -&gt; Semantic [ImportDecl]
</span><a href="Semantic.html#irgenImports"><span class="hs-identifier hs-var hs-var">irgenImports</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; Semantic [ImportDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-530"></span><span class="annot"><a href="Semantic.html#irgenImports"><span class="hs-identifier hs-var">irgenImports</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204574"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204574"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ImportDecl"><span class="hs-identifier hs-type">P.ImportDecl</span></a></span><span> </span><span id="local-6989586621679204576"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204576"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679204577"><span class="annot"><span class="annottext">[Located ImportDecl]
</span><a href="#local-6989586621679204577"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204578"><span class="annot"><span class="annottext">importSymbol :: ImportDecl
</span><a href="#local-6989586621679204578"><span class="hs-identifier hs-var hs-var">importSymbol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Range -&gt; ImportDecl
</span><a href="AST.html#ImportDecl"><span class="hs-identifier hs-var">ImportDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204576"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204574"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><span class="annottext">ImportDecl -&gt; Semantic ()
</span><a href="Semantic.html#addImportDef"><span class="hs-identifier hs-var">addImportDef</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621679204578"><span class="hs-identifier hs-var">importSymbol</span></a></span><span>
</span><span id="line-533"></span><span>  </span><span class="hs-comment">-- TODO: This kind of recursions potentially lead to stack overflows.</span><span>
</span><span id="line-534"></span><span>  </span><span class="hs-comment">-- For now it should do the job. Will try to fix in the future.</span><span>
</span><span id="line-535"></span><span>  </span><span id="local-6989586621679204580"><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621679204580"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located ImportDecl] -&gt; Semantic [ImportDecl]
</span><a href="Semantic.html#irgenImports"><span class="hs-identifier hs-var">irgenImports</span></a></span><span> </span><span class="annot"><span class="annottext">[Located ImportDecl]
</span><a href="#local-6989586621679204577"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-536"></span><span>  </span><span class="annot"><span class="annottext">[ImportDecl] -&gt; Semantic [ImportDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">([ImportDecl] -&gt; Semantic [ImportDecl])
-&gt; [ImportDecl] -&gt; Semantic [ImportDecl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><a href="#local-6989586621679204578"><span class="hs-identifier hs-var">importSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">ImportDecl -&gt; [ImportDecl] -&gt; [ImportDecl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[ImportDecl]
</span><a href="#local-6989586621679204580"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-537"></span><span>
</span><span id="line-538"></span><span class="annot"><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-type">irgenFieldDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#FieldDecl"><span class="hs-identifier hs-type">P.FieldDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-539"></span><span id="irgenFieldDecls"><span class="annot"><span class="annottext">irgenFieldDecls :: [Located FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-var hs-var">irgenFieldDecls</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-540"></span><span class="annot"><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-var">irgenFieldDecls</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204581"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204581"><span class="hs-identifier hs-var">pos</span></a></span></span><span> </span><span id="local-6989586621679204582"><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204582"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679204583"><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204583"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-541"></span><span>  </span><span id="local-6989586621679204584"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204584"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Semantic FieldDecl] -&gt; Semantic [FieldDecl]
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
forall (m :: * -&gt; *) a. Monad m =&gt; [m a] -&gt; m [a]
</span><span class="hs-identifier hs-var">sequence</span></span><span> </span><span class="annot"><span class="annottext">([Semantic FieldDecl] -&gt; Semantic [FieldDecl])
-&gt; [Semantic FieldDecl] -&gt; Semantic [FieldDecl]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">FieldDecl -&gt; [Semantic FieldDecl]
</span><a href="#local-6989586621679204586"><span class="hs-identifier hs-var">convertFieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204582"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span id="local-6989586621679204587"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204587"><span class="hs-identifier hs-var">vars</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="#local-6989586621679204588"><span class="hs-identifier hs-var">addVariables</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204584"><span class="hs-identifier hs-var">fields</span></a></span><span>
</span><span id="line-543"></span><span>  </span><span id="local-6989586621679204589"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204589"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-var">irgenFieldDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204583"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-544"></span><span>  </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204587"><span class="hs-identifier hs-var">vars</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; [FieldDecl] -&gt; [FieldDecl]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204589"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-546"></span><span>    </span><span id="local-6989586621679204586"><span class="annot"><span class="annottext">convertFieldDecl :: FieldDecl -&gt; [Semantic FieldDecl]
</span><a href="#local-6989586621679204586"><span class="hs-identifier hs-var hs-var">convertFieldDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#FieldDecl"><span class="hs-identifier hs-type">P.FieldDecl</span></a></span><span> </span><span id="local-6989586621679204591"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204591"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span id="local-6989586621679204592"><span class="annot"><span class="annottext">[Located FieldElem]
</span><a href="#local-6989586621679204592"><span class="hs-identifier hs-var">elems</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-547"></span><span>      </span><span class="annot"><span class="annottext">[Located FieldElem]
</span><a href="#local-6989586621679204592"><span class="hs-identifier hs-var">elems</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldElem]
-&gt; (Located FieldElem -&gt; Semantic FieldDecl)
-&gt; [Semantic FieldDecl]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679204593"><span class="annot"><span class="annottext">Located FieldElem
</span><a href="#local-6989586621679204593"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Located FieldElem
</span><a href="#local-6989586621679204593"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-548"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204594"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204594"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ScalarField"><span class="hs-identifier hs-type">P.ScalarField</span></a></span><span> </span><span id="local-6989586621679204596"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204596"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-549"></span><span>          </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204594"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-550"></span><span>          </span><span class="annot"><span class="annottext">FieldDecl -&gt; Semantic FieldDecl
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FieldDecl -&gt; Semantic FieldDecl)
-&gt; FieldDecl -&gt; Semantic FieldDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Range -&gt; FieldDecl
</span><a href="AST.html#FieldDecl"><span class="hs-identifier hs-var">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204596"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var">irgenType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204591"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204581"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-551"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204597"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204597"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#VectorField"><span class="hs-identifier hs-type">P.VectorField</span></a></span><span> </span><span id="local-6989586621679204599"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204599"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621679204600"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204600"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-552"></span><span>          </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204581"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-553"></span><span>          </span><span id="local-6989586621679204601"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204601"><span class="hs-identifier hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic Int64
</span><a href="Semantic.html#checkInt64Literal"><span class="hs-identifier hs-var">checkInt64Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204600"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-554"></span><span>          </span><span class="annot"><span class="annottext">FieldDecl -&gt; Semantic FieldDecl
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(FieldDecl -&gt; Semantic FieldDecl)
-&gt; FieldDecl -&gt; Semantic FieldDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Range -&gt; FieldDecl
</span><a href="AST.html#FieldDecl"><span class="hs-identifier hs-var">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204599"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Int64 -&gt; Type
</span><a href="AST.html#ArrayType"><span class="hs-identifier hs-var">ArrayType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var">irgenType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204591"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204601"><span class="hs-identifier hs-var">sz</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204581"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span id="local-6989586621679204588"><span class="annot"><span class="annottext">addVariables :: [FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="#local-6989586621679204588"><span class="hs-identifier hs-var hs-var">addVariables</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="#local-6989586621679204588"><span class="hs-identifier hs-var">addVariables</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679204606"><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204606"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679204607"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204607"><span class="hs-identifier hs-var">vs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><span class="annottext">FieldDecl -&gt; Semantic ()
</span><a href="Semantic.html#addVariableDef"><span class="hs-identifier hs-var">addVariableDef</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204606"><span class="hs-identifier hs-var">v</span></a></span><span>
</span><span id="line-558"></span><span>      </span><span id="local-6989586621679204608"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204608"><span class="hs-identifier hs-var">vs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="#local-6989586621679204588"><span class="hs-identifier hs-var">addVariables</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204607"><span class="hs-identifier hs-var">vs</span></a></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; Semantic [FieldDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">FieldDecl
</span><a href="#local-6989586621679204606"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">FieldDecl -&gt; [FieldDecl] -&gt; [FieldDecl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204608"><span class="hs-identifier hs-var">vs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="annot"><a href="Semantic.html#irgenMethodDecls"><span class="hs-identifier hs-type">irgenMethodDecls</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#MethodDecl"><span class="hs-identifier hs-type">P.MethodDecl</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-562"></span><span id="irgenMethodDecls"><span class="annot"><span class="annottext">irgenMethodDecls :: [Located MethodDecl] -&gt; Semantic [MethodDecl]
</span><a href="Semantic.html#irgenMethodDecls"><span class="hs-identifier hs-var hs-var">irgenMethodDecls</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[MethodDecl] -&gt; Semantic [MethodDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-563"></span><span class="annot"><a href="Semantic.html#irgenMethodDecls"><span class="hs-identifier hs-var">irgenMethodDecls</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204609"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204609"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679204610"><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204610"><span class="hs-identifier hs-var">decl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679204611"><span class="annot"><span class="annottext">[Located MethodDecl]
</span><a href="#local-6989586621679204611"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204609"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span id="local-6989586621679204612"><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204612"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodDecl -&gt; Semantic MethodDecl
</span><a href="#local-6989586621679204613"><span class="hs-identifier hs-var">convertMethodDecl</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204610"><span class="hs-identifier hs-var">decl</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-comment">-- Semantic[8] and Semantic[9]</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-comment">-- checkMethod method</span><span>
</span><span id="line-568"></span><span>  </span><span class="annot"><span class="annottext">MethodDecl -&gt; Semantic ()
</span><a href="Semantic.html#addMethodDef"><span class="hs-identifier hs-var">addMethodDef</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204612"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679204614"><span class="annot"><span class="annottext">[MethodDecl]
</span><a href="#local-6989586621679204614"><span class="hs-identifier hs-var">rest'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located MethodDecl] -&gt; Semantic [MethodDecl]
</span><a href="Semantic.html#irgenMethodDecls"><span class="hs-identifier hs-var">irgenMethodDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Located MethodDecl]
</span><a href="#local-6989586621679204611"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="annot"><span class="annottext">[MethodDecl] -&gt; Semantic [MethodDecl]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204612"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl -&gt; [MethodDecl] -&gt; [MethodDecl]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[MethodDecl]
</span><a href="#local-6989586621679204614"><span class="hs-identifier hs-var">rest'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-572"></span><span>    </span><span id="local-6989586621679204613"><span class="annot"><span class="annottext">convertMethodDecl :: MethodDecl -&gt; Semantic MethodDecl
</span><a href="#local-6989586621679204613"><span class="hs-identifier hs-var hs-var">convertMethodDecl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#MethodDecl"><span class="hs-identifier hs-type">P.MethodDecl</span></a></span><span> </span><span id="local-6989586621679204616"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204616"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621679204617"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204617"><span class="hs-identifier hs-var">returnType</span></a></span></span><span> </span><span id="local-6989586621679204618"><span class="annot"><span class="annottext">[Located Argument]
</span><a href="#local-6989586621679204618"><span class="hs-identifier hs-var">arguments</span></a></span></span><span> </span><span id="local-6989586621679204619"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204619"><span class="hs-identifier hs-var">block</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-573"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204620"><span class="annot"><span class="annottext">sig :: MethodSig
</span><a href="#local-6989586621679204620"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Maybe Type -&gt; [Argument] -&gt; MethodSig
</span><a href="AST.html#MethodSig"><span class="hs-identifier hs-var">MethodSig</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204616"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var">irgenType</span></a></span><span> </span><span class="annot"><span class="annottext">(Type -&gt; Type) -&gt; Maybe Type -&gt; Maybe Type
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204617"><span class="hs-identifier hs-var">returnType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204621"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span id="local-6989586621679204622"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204622"><span class="hs-identifier hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#MethodBlock"><span class="hs-identifier hs-var">MethodBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodSig -&gt; Maybe MethodSig
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204620"><span class="hs-identifier hs-var">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204619"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-575"></span><span>      </span><span class="annot"><span class="annottext">MethodDecl -&gt; Semantic MethodDecl
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MethodDecl -&gt; Semantic MethodDecl)
-&gt; MethodDecl -&gt; Semantic MethodDecl
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">MethodSig -&gt; Block -&gt; Range -&gt; MethodDecl
</span><a href="AST.html#MethodDecl"><span class="hs-identifier hs-var">MethodDecl</span></a></span><span> </span><span class="annot"><span class="annottext">MethodSig
</span><a href="#local-6989586621679204620"><span class="hs-identifier hs-var">sig</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204622"><span class="hs-identifier hs-var">block</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204609"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-577"></span><span>        </span><span id="local-6989586621679204621"><span class="annot"><span class="annottext">args :: [Argument]
</span><a href="#local-6989586621679204621"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-578"></span><span>          </span><span class="annot"><span class="annottext">[Located Argument]
</span><a href="#local-6989586621679204618"><span class="hs-identifier hs-var">arguments</span></a></span><span> </span><span class="annot"><span class="annottext">[Located Argument] -&gt; (Located Argument -&gt; Argument) -&gt; [Argument]
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><span class="hs-operator hs-var">&lt;&amp;&gt;</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204625"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204625"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#Argument"><span class="hs-identifier hs-type">P.Argument</span></a></span><span> </span><span id="local-6989586621679204627"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204627"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621679204628"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204628"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-579"></span><span>            </span><span class="annot"><span class="annottext">Name -&gt; Type -&gt; Range -&gt; Argument
</span><a href="AST.html#Argument"><span class="hs-identifier hs-var">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204627"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type
</span><a href="Semantic.html#irgenType"><span class="hs-identifier hs-var">irgenType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204628"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204625"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="annot"><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-type">irgenBlock</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Semantic.html#BlockType"><span class="hs-identifier hs-type">BlockType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.Tree.html#Block"><span class="hs-identifier hs-type">P.Block</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Block"><span class="hs-identifier hs-type">Block</span></a></span><span>
</span><span id="line-582"></span><span id="irgenBlock"><span class="annot"><span class="annottext">irgenBlock :: BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var hs-var">irgenBlock</span></a></span></span><span> </span><span id="local-6989586621679204630"><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204630"><span class="hs-identifier hs-var">blockType</span></a></span></span><span> </span><span id="local-6989586621679204631"><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204631"><span class="hs-identifier hs-var">sig</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#Block"><span class="hs-identifier hs-type">P.Block</span></a></span><span> </span><span id="local-6989586621679204633"><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204633"><span class="hs-identifier hs-var">fieldDecls</span></a></span></span><span> </span><span id="local-6989586621679204634"><span class="annot"><span class="annottext">[Located Statement]
</span><a href="#local-6989586621679204634"><span class="hs-identifier hs-var">statements</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-583"></span><span>  </span><span id="local-6989586621679204635"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204635"><span class="hs-identifier hs-var">nextID</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Semantic ScopeID
</span><a href="Semantic.html#enterScope"><span class="hs-identifier hs-var">enterScope</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="#local-6989586621679204630"><span class="hs-identifier hs-var">blockType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204631"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-584"></span><span>  </span><span id="local-6989586621679204636"><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204636"><span class="hs-identifier hs-var">fields</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl] -&gt; Semantic [FieldDecl]
</span><a href="Semantic.html#irgenFieldDecls"><span class="hs-identifier hs-var">irgenFieldDecls</span></a></span><span> </span><span class="annot"><span class="annottext">[Located FieldDecl]
</span><a href="#local-6989586621679204633"><span class="hs-identifier hs-var">fieldDecls</span></a></span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679204637"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679204637"><span class="hs-identifier hs-var">stmts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located Statement] -&gt; Semantic [Statement]
</span><a href="Semantic.html#irgenStatements"><span class="hs-identifier hs-var">irgenStatements</span></a></span><span> </span><span class="annot"><span class="annottext">[Located Statement]
</span><a href="#local-6989586621679204634"><span class="hs-identifier hs-var">statements</span></a></span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204639"><span class="annot"><span class="annottext">block :: Block
</span><a href="#local-6989586621679204639"><span class="hs-identifier hs-var hs-var">block</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[FieldDecl] -&gt; [Statement] -&gt; ScopeID -&gt; Block
</span><a href="AST.html#Block"><span class="hs-identifier hs-var">Block</span></a></span><span> </span><span class="annot"><span class="annottext">[FieldDecl]
</span><a href="#local-6989586621679204636"><span class="hs-identifier hs-var">fields</span></a></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679204637"><span class="hs-identifier hs-var">stmts</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204635"><span class="hs-identifier hs-var">nextID</span></a></span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="annottext">Semantic ()
</span><a href="Semantic.html#exitScope"><span class="hs-identifier hs-var">exitScope</span></a></span><span>
</span><span id="line-588"></span><span>  </span><span class="annot"><span class="annottext">Block -&gt; Semantic Block
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204639"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-589"></span><span>
</span><span id="line-590"></span><span class="annot"><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-type">irgenLocation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Location"><span class="hs-identifier hs-type">P.Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span>
</span><span id="line-591"></span><span id="irgenLocation"><span class="annot"><span class="annottext">irgenLocation :: Location -&gt; Semantic Location
</span><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-var hs-var">irgenLocation</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ScalarLocation"><span class="hs-identifier hs-type">P.ScalarLocation</span></a></span><span> </span><span id="local-6989586621679204643"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204643"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-comment">-- Semantic[10] (checked in lookupVariable')</span><span>
</span><span id="line-593"></span><span>  </span><span id="local-6989586621679204644"><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204644"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupVariable%27"><span class="hs-identifier hs-var">lookupVariable'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204643"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-594"></span><span>  </span><span id="local-6989586621679204645"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204645"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204646"><span class="annot"><span class="annottext">tpe :: Type
</span><a href="#local-6989586621679204646"><span class="hs-identifier hs-var hs-var">tpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Argument -&gt; Type)
-&gt; (FieldDecl -&gt; Type) -&gt; Either Argument FieldDecl -&gt; Type
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204648"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204648"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204648"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204649"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204649"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204649"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204644"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204650"><span class="annot"><span class="annottext">sz :: Maybe Int64
</span><a href="#local-6989586621679204650"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>        </span><span class="annot"><span class="annottext">(Argument -&gt; Maybe Int64)
-&gt; (FieldDecl -&gt; Maybe Int64)
-&gt; Either Argument FieldDecl
-&gt; Maybe Int64
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span>
</span><span id="line-598"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int64 -&gt; Argument -&gt; Maybe Int64
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204652"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204652"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204652"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-600"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204653"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204653"><span class="hs-identifier hs-var">sz'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204653"><span class="hs-identifier hs-var">sz'</span></a></span><span>
</span><span id="line-601"></span><span>              </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-602"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>          </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204644"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-604"></span><span>  </span><span class="hs-comment">-- Semantic[12]</span><span>
</span><span id="line-605"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679204650"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int64
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Location -&gt; Semantic Location) -&gt; Location -&gt; Semantic Location
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Expr
-&gt; Either Argument FieldDecl
-&gt; Type
-&gt; Range
-&gt; Location
</span><a href="AST.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204643"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204644"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204646"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204645"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204655"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204655"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Location -&gt; Semantic Location) -&gt; Location -&gt; Semantic Location
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Expr
-&gt; Either Argument FieldDecl
-&gt; Type
-&gt; Range
-&gt; Location
</span><a href="AST.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204643"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204644"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Int64 -&gt; Type
</span><a href="AST.html#ArrayType"><span class="hs-identifier hs-var">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204646"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204655"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204645"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-608"></span><span class="annot"><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-var">irgenLocation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#VectorLocation"><span class="hs-identifier hs-type">P.VectorLocation</span></a></span><span> </span><span id="local-6989586621679204657"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204657"><span class="hs-identifier hs-var">id</span></a></span></span><span> </span><span id="local-6989586621679204658"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204658"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621679204659"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204659"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="annot"><span class="annottext">Expr_
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204660"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204660"><span class="hs-identifier hs-var">indexTpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204658"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-comment">-- Semantic[10] (checked in lookupVariable')</span><span>
</span><span id="line-611"></span><span>  </span><span id="local-6989586621679204662"><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204662"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupVariable%27"><span class="hs-identifier hs-var">lookupVariable'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204657"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-612"></span><span>  </span><span id="local-6989586621679204663"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204663"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204664"><span class="annot"><span class="annottext">tpe :: Type
</span><a href="#local-6989586621679204664"><span class="hs-identifier hs-var hs-var">tpe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Argument -&gt; Type)
-&gt; (FieldDecl -&gt; Type) -&gt; Either Argument FieldDecl -&gt; Type
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204665"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204665"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204665"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204666"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204666"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204666"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204662"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204667"><span class="annot"><span class="annottext">sz :: Maybe Int64
</span><a href="#local-6989586621679204667"><span class="hs-identifier hs-var hs-var">sz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-615"></span><span>        </span><span class="annot"><span class="annottext">(Argument -&gt; Maybe Int64)
-&gt; (FieldDecl -&gt; Maybe Int64)
-&gt; Either Argument FieldDecl
-&gt; Maybe Int64
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span>
</span><span id="line-616"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Int64 -&gt; Argument -&gt; Maybe Int64
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204668"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204668"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204668"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-618"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204669"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204669"><span class="hs-identifier hs-var">sz'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Maybe Int64
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204669"><span class="hs-identifier hs-var">sz'</span></a></span><span>
</span><span id="line-619"></span><span>              </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-620"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>          </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204662"><span class="hs-identifier hs-var">def</span></a></span><span>
</span><span id="line-622"></span><span>  </span><span class="hs-comment">-- Semantic[12]</span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204660"><span class="hs-identifier hs-var">indexTpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Index must be of int type!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int64
</span><a href="#local-6989586621679204667"><span class="hs-identifier hs-var">sz</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-625"></span><span>    </span><span class="annot"><span class="annottext">Maybe Int64
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-626"></span><span>      </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-627"></span><span>        </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Cannot access index of scalar variable &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204657"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-628"></span><span>      </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Location -&gt; Semantic Location) -&gt; Location -&gt; Semantic Location
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Expr
-&gt; Either Argument FieldDecl
-&gt; Type
-&gt; Range
-&gt; Location
</span><a href="AST.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204657"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204662"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204664"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204663"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Location -&gt; Semantic Location) -&gt; Location -&gt; Semantic Location
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name
-&gt; Maybe Expr
-&gt; Either Argument FieldDecl
-&gt; Type
-&gt; Range
-&gt; Location
</span><a href="AST.html#Location"><span class="hs-identifier hs-var">Location</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204657"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204659"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204662"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204664"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204663"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="annot"><a href="Semantic.html#checkAssignType"><span class="hs-identifier hs-type">checkAssignType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="AST.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-632"></span><span id="checkAssignType"><span class="annot"><span class="annottext">checkAssignType :: Type -&gt; Type -&gt; Bool
</span><a href="Semantic.html#checkAssignType"><span class="hs-identifier hs-var hs-var">checkAssignType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span id="local-6989586621679204671"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204671"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679204672"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204672"><span class="hs-identifier hs-var">exprType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204671"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204672"><span class="hs-identifier hs-var">exprType</span></a></span><span>
</span><span id="line-633"></span><span class="annot"><a href="Semantic.html#checkAssignType"><span class="hs-identifier hs-var">checkAssignType</span></a></span><span> </span><span id="local-6989586621679204673"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204673"><span class="hs-identifier hs-var">locType</span></a></span></span><span> </span><span id="local-6989586621679204674"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204674"><span class="hs-identifier hs-var">exprType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204673"><span class="hs-identifier hs-var">locType</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204674"><span class="hs-identifier hs-var">exprType</span></a></span><span>
</span><span id="line-634"></span><span>
</span><span id="line-635"></span><span class="annot"><a href="Semantic.html#recordSymbolWrite"><span class="hs-identifier hs-type">recordSymbolWrite</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-636"></span><span id="recordSymbolWrite"><span class="annot"><span class="annottext">recordSymbolWrite :: Location -&gt; Semantic ()
</span><a href="Semantic.html#recordSymbolWrite"><span class="hs-identifier hs-var hs-var">recordSymbolWrite</span></a></span></span><span> </span><span id="local-6989586621679204676"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204676"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-637"></span><span>  </span><span id="local-6989586621679204677"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204677"><span class="hs-identifier hs-var">sid</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic ScopeID
</span><a href="Semantic.html#getCurrentScopeID"><span class="hs-identifier hs-var">getCurrentScopeID</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204678"><span class="annot"><span class="annottext">name :: Name
</span><a href="#local-6989586621679204678"><span class="hs-identifier hs-var hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204676"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Location -&gt; Getting Name Location Name -&gt; Name
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting Name Location Name
</span><span class="">#name</span></span><span>
</span><span id="line-639"></span><span>  </span><span id="local-6989586621679204679"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204679"><span class="hs-identifier hs-var">varScope</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ScopeID
</span><a href="Semantic.html#lookupVariableScope%27"><span class="hs-identifier hs-var">lookupVariableScope'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204678"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl -&gt; Type
</span><a href="AST.html#typeOfDef"><span class="hs-identifier hs-var">typeOfDef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204676"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">Location
-&gt; Getting
     (Either Argument FieldDecl) Location (Either Argument FieldDecl)
-&gt; Either Argument FieldDecl
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Getting
  (Either Argument FieldDecl) Location (Either Argument FieldDecl)
</span><span class="">#variableDef</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#Void"><span class="hs-identifier hs-var">Void</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>    </span><span class="annot"><a href="AST.html#Ptr"><span class="hs-identifier hs-type">Ptr</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>    </span><span id="local-6989586621679204683"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204683"><span class="hs-identifier hs-var">_ScalarType</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-645"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204684"><span class="annot"><span class="annottext">newSet :: Set (ScopeID, Name)
</span><a href="#local-6989586621679204684"><span class="hs-identifier hs-var hs-var">newSet</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(ScopeID, Name)] -&gt; Set (ScopeID, Name)
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([(ScopeID, Name)] -&gt; Set (ScopeID, Name))
-&gt; [(ScopeID, Name)] -&gt; Set (ScopeID, Name)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((ScopeID, Name) -&gt; Bool) -&gt; [(ScopeID, Name)] -&gt; [(ScopeID, Name)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679204686"><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204686"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204686"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">ScopeID
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">ScopeID
</span><a href="#local-6989586621679204679"><span class="hs-identifier hs-var">varScope</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204678"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-cpp">
      #symbolWrites %= Map.insertWith Set.union sid newSet
</span><span>
</span><span id="line-648"></span><span class="annot"><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-type">irgenAssign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Location"><span class="hs-identifier hs-type">P.Location</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Parser.Tree.html#AssignExpr"><span class="hs-identifier hs-type">P.AssignExpr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Assignment"><span class="hs-identifier hs-type">Assignment</span></a></span><span>
</span><span id="line-649"></span><span id="irgenAssign"><span class="annot"><span class="annottext">irgenAssign :: Location -&gt; AssignExpr -&gt; Semantic Assignment
</span><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-var hs-var">irgenAssign</span></a></span></span><span> </span><span id="local-6989586621679204690"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204690"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#AssignExpr"><span class="hs-identifier hs-type">P.AssignExpr</span></a></span><span> </span><span id="local-6989586621679204692"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204692"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679204693"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204693"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-650"></span><span>  </span><span id="local-6989586621679204694"><span class="annot"><span class="annottext">loc' :: Location
</span><a href="#local-6989586621679204694"><span class="hs-identifier hs-var">loc'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Location :: Location -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3ALocation"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204696"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204696"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
</span><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-var">irgenLocation</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204690"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679204697"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204697"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204698"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204698"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204693"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span id="local-6989586621679204699"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204699"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span class="hs-comment">-- Semantic[19]</span><span>
</span><span id="line-654"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-655"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
</span><a href="Semantic.html#checkAssignType"><span class="hs-identifier hs-var">checkAssignType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204696"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204698"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Type -&gt; Name) -&gt; Type -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Type -&gt; Type -&gt; Name) (Type -&gt; Type -&gt; Name)
</span><span class="hs-string">&quot;Assign statement has different types: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Type -&gt; Name) (Type -&gt; Type -&gt; Name)
-&gt; Format Name (Type -&gt; Type -&gt; Name)
-&gt; Format Name (Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot; and &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204696"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204698"><span class="hs-identifier hs-var">tpe'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204700"><span class="annot"><span class="annottext">op' :: AssignOp
</span><a href="#local-6989586621679204700"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; AssignOp
</span><a href="AST.html#parseAssignOp"><span class="hs-identifier hs-var">parseAssignOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204692"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-658"></span><span>  </span><span class="hs-comment">-- Semantic[20]</span><span>
</span><span id="line-659"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">AssignOp
</span><a href="#local-6989586621679204700"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">AssignOp -&gt; AssignOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AssignOp
</span><a href="AST.html#IncAssign"><span class="hs-identifier hs-var">IncAssign</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">AssignOp
</span><a href="#local-6989586621679204700"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">AssignOp -&gt; AssignOp -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">AssignOp
</span><a href="AST.html#DecAssign"><span class="hs-identifier hs-var">DecAssign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204696"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Inc or dec assign only works with int type!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>  </span><span class="hs-comment">-- Record symbol write to ease cfg construction</span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><span class="annottext">Location -&gt; Semantic ()
</span><a href="Semantic.html#recordSymbolWrite"><span class="hs-identifier hs-var">recordSymbolWrite</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204694"><span class="hs-identifier hs-var">loc'</span></a></span><span>
</span><span id="line-664"></span><span>  </span><span class="annot"><span class="annottext">Assignment -&gt; Semantic Assignment
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Assignment -&gt; Semantic Assignment)
-&gt; Assignment -&gt; Semantic Assignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Location -&gt; AssignOp -&gt; Maybe Expr -&gt; Range -&gt; Assignment
</span><a href="AST.html#Assignment"><span class="hs-identifier hs-var">Assignment</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204694"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">AssignOp
</span><a href="#local-6989586621679204700"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204697"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204699"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-665"></span><span class="annot"><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-var">irgenAssign</span></a></span><span> </span><span id="local-6989586621679204706"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204706"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#IncrementExpr"><span class="hs-identifier hs-type">P.IncrementExpr</span></a></span><span> </span><span id="local-6989586621679204708"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204708"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-666"></span><span>  </span><span id="local-6989586621679204709"><span class="annot"><span class="annottext">loc' :: Location
</span><a href="#local-6989586621679204709"><span class="hs-identifier hs-var">loc'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Location :: Location -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3ALocation"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204710"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204710"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
</span><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-var">irgenLocation</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204706"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-667"></span><span>  </span><span id="local-6989586621679204711"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204711"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204712"><span class="annot"><span class="annottext">op' :: AssignOp
</span><a href="#local-6989586621679204712"><span class="hs-identifier hs-var hs-var">op'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name -&gt; AssignOp
</span><a href="AST.html#parseAssignOp"><span class="hs-identifier hs-var">parseAssignOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204708"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-comment">-- Semantic[20]</span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204710"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Inc or dec operator only works on int type!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-comment">-- Record symbol write to ease cfg construction</span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><span class="annottext">Location -&gt; Semantic ()
</span><a href="Semantic.html#recordSymbolWrite"><span class="hs-identifier hs-var">recordSymbolWrite</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204709"><span class="hs-identifier hs-var">loc'</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span class="annot"><span class="annottext">Assignment -&gt; Semantic Assignment
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Assignment -&gt; Semantic Assignment)
-&gt; Assignment -&gt; Semantic Assignment
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Location -&gt; AssignOp -&gt; Maybe Expr -&gt; Range -&gt; Assignment
</span><a href="AST.html#Assignment"><span class="hs-identifier hs-var">Assignment</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204709"><span class="hs-identifier hs-var">loc'</span></a></span><span> </span><span class="annot"><span class="annottext">AssignOp
</span><a href="#local-6989586621679204712"><span class="hs-identifier hs-var">op'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204711"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="annot"><a href="Semantic.html#irgenStatements"><span class="hs-identifier hs-type">irgenStatements</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#Statement"><span class="hs-identifier hs-type">P.Statement</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="AST.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-676"></span><span id="irgenStatements"><span class="annot"><span class="annottext">irgenStatements :: [Located Statement] -&gt; Semantic [Statement]
</span><a href="Semantic.html#irgenStatements"><span class="hs-identifier hs-var hs-var">irgenStatements</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Statement] -&gt; Semantic [Statement]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-677"></span><span class="annot"><a href="Semantic.html#irgenStatements"><span class="hs-identifier hs-var">irgenStatements</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204713"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204713"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span id="local-6989586621679204714"><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679204714"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679204715"><span class="annot"><span class="annottext">[Located Statement]
</span><a href="#local-6989586621679204715"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-678"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204713"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-679"></span><span>  </span><span id="local-6989586621679204716"><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679204716"><span class="hs-identifier hs-var">s'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
</span><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679204714"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-680"></span><span>  </span><span id="local-6989586621679204718"><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679204718"><span class="hs-identifier hs-var">xs'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Located Statement] -&gt; Semantic [Statement]
</span><a href="Semantic.html#irgenStatements"><span class="hs-identifier hs-var">irgenStatements</span></a></span><span> </span><span class="annot"><span class="annottext">[Located Statement]
</span><a href="#local-6989586621679204715"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-681"></span><span>  </span><span class="annot"><span class="annottext">[Statement] -&gt; Semantic [Statement]
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Statement
</span><a href="#local-6989586621679204716"><span class="hs-identifier hs-var">s'</span></a></span><span> </span><span class="annot"><span class="annottext">Statement -&gt; [Statement] -&gt; [Statement]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Statement]
</span><a href="#local-6989586621679204718"><span class="hs-identifier hs-var">xs'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="annot"><a href="Semantic.html#irgenMethod"><span class="hs-identifier hs-type">irgenMethod</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#MethodCall"><span class="hs-identifier hs-type">P.MethodCall</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#MethodCall"><span class="hs-identifier hs-type">MethodCall</span></a></span><span>
</span><span id="line-684"></span><span id="irgenMethod"><span class="annot"><span class="annottext">irgenMethod :: MethodCall -&gt; Semantic MethodCall
</span><a href="Semantic.html#irgenMethod"><span class="hs-identifier hs-var hs-var">irgenMethod</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#MethodCall"><span class="hs-identifier hs-type">P.MethodCall</span></a></span><span> </span><span id="local-6989586621679204721"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span></span><span> </span><span id="local-6989586621679204722"><span class="annot"><span class="annottext">[Located ImportArg]
</span><a href="#local-6989586621679204722"><span class="hs-identifier hs-var">args'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-comment">-- Semantic[2] and Semantic[11]</span><span>
</span><span id="line-686"></span><span>  </span><span id="local-6989586621679204723"><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204723"><span class="hs-identifier hs-var">decl'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Maybe (Either ImportDecl MethodDecl))
</span><a href="Semantic.html#lookupMethod"><span class="hs-identifier hs-var">lookupMethod</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-687"></span><span>  </span><span id="local-6989586621679204724"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Located ImportArg -&gt; Semantic Expr)
-&gt; [Located ImportArg] -&gt; Semantic [Expr]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Located ImportArg -&gt; Semantic Expr
</span><a href="Semantic.html#irgenImportArg"><span class="hs-identifier hs-var">irgenImportArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Located ImportArg]
</span><a href="#local-6989586621679204722"><span class="hs-identifier hs-var">args'</span></a></span><span>
</span><span id="line-688"></span><span>  </span><span id="local-6989586621679204727"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204727"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><a href="#local-6989586621679204723"><span class="hs-identifier hs-var">decl'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><span class="annottext">Maybe (Either ImportDecl MethodDecl)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>      </span><span id="local-6989586621679204728"><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204728"><span class="hs-identifier hs-var">currentMethod</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic (Maybe MethodSig)
</span><a href="Semantic.html#getMethodSignature"><span class="hs-identifier hs-var">getMethodSignature</span></a></span><span>
</span><span id="line-692"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><a href="#local-6989586621679204728"><span class="hs-identifier hs-var">currentMethod</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-693"></span><span>        </span><span class="hs-comment">-- Recursive method calling itself</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span id="local-6989586621679204729"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204729"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204730"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204730"><span class="hs-identifier hs-var">formal</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204729"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Name -&gt; Name -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-695"></span><span>          </span><span class="annot"><span class="annottext">[Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204731"><span class="hs-identifier hs-var">checkCallingSemantics</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204730"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span><span>
</span><span id="line-696"></span><span>          </span><span class="annot"><span class="annottext">MethodCall -&gt; Semantic MethodCall
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MethodCall -&gt; Semantic MethodCall)
-&gt; MethodCall -&gt; Semantic MethodCall
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Expr] -&gt; Range -&gt; MethodCall
</span><a href="AST.html#MethodCall"><span class="hs-identifier hs-var">MethodCall</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204727"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-697"></span><span>        </span><span class="annot"><span class="annottext">Maybe MethodSig
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic MethodCall
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic MethodCall) -&gt; Name -&gt; Semantic MethodCall
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; not declared!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-698"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204733"><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204733"><span class="hs-identifier hs-var">decl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204733"><span class="hs-identifier hs-var">decl</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">MethodCall -&gt; Semantic MethodCall
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MethodCall -&gt; Semantic MethodCall)
-&gt; MethodCall -&gt; Semantic MethodCall
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Expr] -&gt; Range -&gt; MethodCall
</span><a href="AST.html#MethodCall"><span class="hs-identifier hs-var">MethodCall</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204727"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679204734"><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204734"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-701"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204735"><span class="annot"><span class="annottext">formal :: [Argument]
</span><a href="#local-6989586621679204735"><span class="hs-identifier hs-var hs-var">formal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MethodDecl
</span><a href="#local-6989586621679204734"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">MethodDecl
-&gt; Getting [Argument] MethodDecl [Argument] -&gt; [Argument]
forall s a. s -&gt; Getting a s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(MethodSig -&gt; Const [Argument] MethodSig)
-&gt; MethodDecl -&gt; Const [Argument] MethodDecl
</span><span class="">#sig</span></span><span> </span><span class="annot"><span class="annottext">((MethodSig -&gt; Const [Argument] MethodSig)
 -&gt; MethodDecl -&gt; Const [Argument] MethodDecl)
-&gt; Getting [Argument] MethodSig [Argument]
-&gt; Getting [Argument] MethodDecl [Argument]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Getting [Argument] MethodSig [Argument]
</span><span class="">#args</span></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>        </span><span class="hs-comment">-- Semantic[5] and Semantic[7]</span><span>
</span><span id="line-703"></span><span>        </span><span class="annot"><span class="annottext">[Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204731"><span class="hs-identifier hs-var">checkCallingSemantics</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204735"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span><span>
</span><span id="line-704"></span><span>        </span><span class="annot"><span class="annottext">MethodCall -&gt; Semantic MethodCall
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(MethodCall -&gt; Semantic MethodCall)
-&gt; MethodCall -&gt; Semantic MethodCall
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Name -&gt; [Expr] -&gt; Range -&gt; MethodCall
</span><a href="AST.html#MethodCall"><span class="hs-identifier hs-var">MethodCall</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204724"><span class="hs-identifier hs-var">argsTyped</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204727"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679204737"><span class="annot"><span class="annottext">matchPred :: (Argument, Expr) -&gt; Bool
</span><a href="#local-6989586621679204737"><span class="hs-identifier hs-var hs-var">matchPred</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204738"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204738"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204739"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204739"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204738"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204739"><span class="hs-identifier hs-var">tpe'</span></a></span><span>
</span><span id="line-707"></span><span>    </span><span id="local-6989586621679204740"><span class="annot"><span class="annottext">argName :: (Argument, b) -&gt; Name
</span><a href="#local-6989586621679204740"><span class="hs-identifier hs-var hs-var">argName</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span id="local-6989586621679204741"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204741"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204741"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span id="local-6989586621679204742"><span class="annot"><span class="annottext">checkArgNum :: [Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204742"><span class="hs-identifier hs-var hs-var">checkArgNum</span></a></span></span><span> </span><span id="local-6989586621679204743"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204743"><span class="hs-identifier hs-var">formal</span></a></span></span><span> </span><span id="local-6989586621679204744"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204744"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-709"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-710"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Argument] -&gt; ScopeID
forall a. [a] -&gt; ScopeID
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ScopeID
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204743"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">ScopeID -&gt; ScopeID -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">[Expr] -&gt; ScopeID
forall a. [a] -&gt; ScopeID
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ScopeID
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204744"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="annottext">Format Name (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Name -&gt; ScopeID -&gt; ScopeID -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span>
</span><span id="line-713"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format
  (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
  (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
</span><span class="hs-string">&quot;Calling &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format
  (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
  (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format
  (ScopeID -&gt; ScopeID -&gt; Name) (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format
  (ScopeID -&gt; ScopeID -&gt; Name) (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (Name -&gt; ScopeID -&gt; ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; ScopeID -&gt; Name) (ScopeID -&gt; ScopeID -&gt; Name)
</span><span class="hs-string">&quot; with wrong number of args. Required: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; ScopeID -&gt; Name) (ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
</span><span class="hs-string">&quot;, supplied: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (ScopeID -&gt; Name) (ScopeID -&gt; Name)
-&gt; Format Name (ScopeID -&gt; Name) -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
forall a r. Integral a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">int</span></span><span> </span><span class="annot"><span class="annottext">Format Name (ScopeID -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (ScopeID -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>              </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-715"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Argument] -&gt; ScopeID
forall a. [a] -&gt; ScopeID
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ScopeID
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204743"><span class="hs-identifier hs-var">formal</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-716"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr] -&gt; ScopeID
forall a. [a] -&gt; ScopeID
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; ScopeID
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204744"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-717"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>    </span><span id="local-6989586621679204746"><span class="annot"><span class="annottext">checkArgType :: [Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204746"><span class="hs-identifier hs-var hs-var">checkArgType</span></a></span></span><span> </span><span id="local-6989586621679204747"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204747"><span class="hs-identifier hs-var">formal</span></a></span></span><span> </span><span id="local-6989586621679204748"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204748"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-719"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204749"><span class="annot"><span class="annottext">mismatch :: [Name]
</span><a href="#local-6989586621679204749"><span class="hs-identifier hs-var hs-var">mismatch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Argument, Expr) -&gt; Name) -&gt; [(Argument, Expr)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">(Argument, Expr) -&gt; Name
forall {b}. (Argument, b) -&gt; Name
</span><a href="#local-6989586621679204740"><span class="hs-identifier hs-var">argName</span></a></span><span> </span><span class="annot"><span class="annottext">([(Argument, Expr)] -&gt; [Name]) -&gt; [(Argument, Expr)] -&gt; [Name]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">((Argument, Expr) -&gt; Bool)
-&gt; [(Argument, Expr)] -&gt; [(Argument, Expr)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool)
-&gt; ((Argument, Expr) -&gt; Bool) -&gt; (Argument, Expr) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Argument, Expr) -&gt; Bool
</span><a href="#local-6989586621679204737"><span class="hs-identifier hs-var">matchPred</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Argument, Expr)] -&gt; [(Argument, Expr)])
-&gt; [(Argument, Expr)] -&gt; [(Argument, Expr)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Argument] -&gt; [Expr] -&gt; [(Argument, Expr)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><span class="hs-identifier hs-var">zip</span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204747"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204748"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-720"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-721"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Name] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679204749"><span class="hs-identifier hs-var">mismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-722"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-723"></span><span>                </span><span class="annot"><span class="annottext">Format Name (Name -&gt; [Name] -&gt; Name) -&gt; Name -&gt; [Name] -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span>
</span><span id="line-724"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; [Name] -&gt; Name) (Name -&gt; [Name] -&gt; Name)
</span><span class="hs-string">&quot;Calling &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; [Name] -&gt; Name) (Name -&gt; [Name] -&gt; Name)
-&gt; Format Name (Name -&gt; [Name] -&gt; Name)
-&gt; Format Name (Name -&gt; [Name] -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format ([Name] -&gt; Name) (Name -&gt; [Name] -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format ([Name] -&gt; Name) (Name -&gt; [Name] -&gt; Name)
-&gt; Format Name ([Name] -&gt; Name)
-&gt; Format Name (Name -&gt; [Name] -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format ([Name] -&gt; Name) ([Name] -&gt; Name)
</span><span class="hs-string">&quot; with wrong type of args: &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format ([Name] -&gt; Name) ([Name] -&gt; Name)
-&gt; Format Name ([Name] -&gt; Name) -&gt; Format Name ([Name] -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name ([Name] -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>                  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-726"></span><span>                  </span><span class="annot"><span class="annottext">[Name]
</span><a href="#local-6989586621679204749"><span class="hs-identifier hs-var">mismatch</span></a></span><span>
</span><span id="line-727"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>    </span><span id="local-6989586621679204750"><span class="annot"><span class="annottext">arrayOrStringTypePred :: Expr -&gt; Bool
</span><a href="#local-6989586621679204750"><span class="hs-identifier hs-var hs-var">arrayOrStringTypePred</span></a></span></span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204751"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204751"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204751"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#StringType"><span class="hs-identifier hs-var">StringType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-731"></span><span>      </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-732"></span><span>    </span><span id="local-6989586621679204753"><span class="annot"><span class="annottext">checkForArrayArg :: [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204753"><span class="hs-identifier hs-var hs-var">checkForArrayArg</span></a></span></span><span> </span><span id="local-6989586621679204754"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204754"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-733"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679204755"><span class="annot"><span class="annottext">arrayArgs :: [Expr]
</span><a href="#local-6989586621679204755"><span class="hs-identifier hs-var hs-var">arrayArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Bool) -&gt; [Expr] -&gt; [Expr]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Bool
</span><a href="#local-6989586621679204750"><span class="hs-identifier hs-var">arrayOrStringTypePred</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204754"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-734"></span><span>       </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-735"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Expr] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204755"><span class="hs-identifier hs-var">arrayArgs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-737"></span><span>                </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span>
</span><span id="line-738"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Argument of array or string type can not be used for method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>                  </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204721"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-740"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>    </span><span id="local-6989586621679204731"><span class="annot"><span class="annottext">checkCallingSemantics :: [Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204731"><span class="hs-identifier hs-var hs-var">checkCallingSemantics</span></a></span></span><span> </span><span id="local-6989586621679204756"><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204756"><span class="hs-identifier hs-var">formal</span></a></span></span><span> </span><span id="local-6989586621679204757"><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204757"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-742"></span><span>      </span><span class="annot"><span class="annottext">[Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204742"><span class="hs-identifier hs-var">checkArgNum</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204756"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204757"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-743"></span><span>      </span><span class="annot"><span class="annottext">[Argument] -&gt; [Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204746"><span class="hs-identifier hs-var">checkArgType</span></a></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><a href="#local-6989586621679204756"><span class="hs-identifier hs-var">formal</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204757"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-744"></span><span>      </span><span class="annot"><span class="annottext">[Expr] -&gt; Semantic ()
</span><a href="#local-6989586621679204753"><span class="hs-identifier hs-var">checkForArrayArg</span></a></span><span> </span><span class="annot"><span class="annottext">[Expr]
</span><a href="#local-6989586621679204757"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-type">irgenStmt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Parser.Tree.html#Statement"><span class="hs-identifier hs-type">P.Statement</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Statement"><span class="hs-identifier hs-type">Statement</span></a></span><span>
</span><span id="line-747"></span><span id="irgenStmt"><span class="annot"><span class="annottext">irgenStmt :: Statement -&gt; Semantic Statement
</span><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var hs-var">irgenStmt</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#AssignStatement"><span class="hs-identifier hs-type">P.AssignStatement</span></a></span><span> </span><span id="local-6989586621679204759"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204759"><span class="hs-identifier hs-var">loc</span></a></span></span><span> </span><span id="local-6989586621679204760"><span class="annot"><span class="annottext">AssignExpr
</span><a href="#local-6989586621679204760"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-748"></span><span>  </span><span id="local-6989586621679204761"><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204761"><span class="hs-identifier hs-var">assign</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; AssignExpr -&gt; Semantic Assignment
</span><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-var">irgenAssign</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204759"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">AssignExpr
</span><a href="#local-6989586621679204760"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-749"></span><span>  </span><span id="local-6989586621679204762"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204762"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-750"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assignment -&gt; Statement_
</span><a href="AST.html#AssignStmt"><span class="hs-identifier hs-var">AssignStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204761"><span class="hs-identifier hs-var">assign</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204762"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-751"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#MethodCallStatement"><span class="hs-identifier hs-type">P.MethodCallStatement</span></a></span><span> </span><span id="local-6989586621679204766"><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204766"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-752"></span><span>  </span><span id="local-6989586621679204767"><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204767"><span class="hs-identifier hs-var">method'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodCall -&gt; Semantic MethodCall
</span><a href="Semantic.html#irgenMethod"><span class="hs-identifier hs-var">irgenMethod</span></a></span><span> </span><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204766"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-753"></span><span>  </span><span id="local-6989586621679204768"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204768"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-754"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodCall -&gt; Statement_
</span><a href="AST.html#MethodCallStmt"><span class="hs-identifier hs-var">MethodCallStmt</span></a></span><span> </span><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204767"><span class="hs-identifier hs-var">method'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204768"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-755"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#IfStatement"><span class="hs-identifier hs-type">P.IfStatement</span></a></span><span> </span><span id="local-6989586621679204771"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204771"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679204772"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204772"><span class="hs-identifier hs-var">block</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-756"></span><span>  </span><span id="local-6989586621679204773"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204773"><span class="hs-identifier hs-var">ifBlock</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204772"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-757"></span><span>  </span><span id="local-6989586621679204774"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204774"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204775"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204775"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204771"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span id="local-6989586621679204776"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204776"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-comment">-- Semantic[14]</span><span>
</span><span id="line-760"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-761"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204775"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name) -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot;The pred of if statment must have type bool, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204775"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Block -&gt; Maybe Block -&gt; Statement_
</span><a href="AST.html#IfStmt"><span class="hs-identifier hs-var">IfStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204774"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204773"><span class="hs-identifier hs-var">ifBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Block
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204776"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-764"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#IfElseStatement"><span class="hs-identifier hs-type">P.IfElseStatement</span></a></span><span> </span><span id="local-6989586621679204779"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204779"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679204780"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204780"><span class="hs-identifier hs-var">ifBlock</span></a></span></span><span> </span><span id="local-6989586621679204781"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204781"><span class="hs-identifier hs-var">elseBlock</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-765"></span><span>  </span><span id="local-6989586621679204782"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204782"><span class="hs-identifier hs-var">ifBlock'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204780"><span class="hs-identifier hs-var">ifBlock</span></a></span><span>
</span><span id="line-766"></span><span>  </span><span id="local-6989586621679204783"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204783"><span class="hs-identifier hs-var">elseBlock'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#IfBlock"><span class="hs-identifier hs-var">IfBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204781"><span class="hs-identifier hs-var">elseBlock</span></a></span><span>
</span><span id="line-767"></span><span>  </span><span id="local-6989586621679204784"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204784"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204785"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204785"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204779"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-768"></span><span>  </span><span id="local-6989586621679204786"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204786"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="hs-comment">-- Semantic[14]</span><span>
</span><span id="line-770"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-771"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204785"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name) -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot;The pred of if statment must have type bool, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204785"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Block -&gt; Maybe Block -&gt; Statement_
</span><a href="AST.html#IfStmt"><span class="hs-identifier hs-var">IfStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204784"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204782"><span class="hs-identifier hs-var">ifBlock'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Block -&gt; Maybe Block
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204783"><span class="hs-identifier hs-var">elseBlock'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204786"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-774"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ForStatement"><span class="hs-identifier hs-type">P.ForStatement</span></a></span><span> </span><span id="local-6989586621679204788"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204788"><span class="hs-identifier hs-var">counter</span></a></span></span><span> </span><span id="local-6989586621679204789"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204789"><span class="hs-identifier hs-var">initExpr</span></a></span></span><span> </span><span id="local-6989586621679204790"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204790"><span class="hs-identifier hs-var">predExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#CounterUpdate"><span class="hs-identifier hs-type">P.CounterUpdate</span></a></span><span> </span><span id="local-6989586621679204792"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204792"><span class="hs-identifier hs-var">updateLoc</span></a></span></span><span> </span><span id="local-6989586621679204793"><span class="annot"><span class="annottext">AssignExpr
</span><a href="#local-6989586621679204793"><span class="hs-identifier hs-var">updateExpr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679204794"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204794"><span class="hs-identifier hs-var">block</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-775"></span><span>  </span><span id="local-6989586621679204795"><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204795"><span class="hs-identifier hs-var">init</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; AssignExpr -&gt; Semantic Assignment
</span><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-var">irgenAssign</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Location
</span><a href="Parser.Tree.html#ScalarLocation"><span class="hs-identifier hs-var">P.ScalarLocation</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204788"><span class="hs-identifier hs-var">counter</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Located Expr -&gt; AssignExpr
</span><a href="Parser.Tree.html#AssignExpr"><span class="hs-identifier hs-var">P.AssignExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;=&quot;</span></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204789"><span class="hs-identifier hs-var">initExpr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span>  </span><span id="local-6989586621679204796"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204796"><span class="hs-identifier hs-var">block'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#ForBlock"><span class="hs-identifier hs-var">ForBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204794"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-777"></span><span>  </span><span id="local-6989586621679204797"><span class="annot"><span class="annottext">predExpr' :: Expr
</span><a href="#local-6989586621679204797"><span class="hs-identifier hs-var">predExpr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204798"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204798"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204790"><span class="hs-identifier hs-var">predExpr</span></a></span><span>
</span><span id="line-778"></span><span>  </span><span id="local-6989586621679204799"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204799"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-comment">-- Semantic[14]</span><span>
</span><span id="line-780"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204798"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name) -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot;The pred of for statment must have type bool, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204798"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>  </span><span id="local-6989586621679204800"><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204800"><span class="hs-identifier hs-var">update</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; AssignExpr -&gt; Semantic Assignment
</span><a href="Semantic.html#irgenAssign"><span class="hs-identifier hs-var">irgenAssign</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204792"><span class="hs-identifier hs-var">updateLoc</span></a></span><span> </span><span class="annot"><span class="annottext">AssignExpr
</span><a href="#local-6989586621679204793"><span class="hs-identifier hs-var">updateExpr</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Assignment -&gt; Expr -&gt; Maybe Assignment -&gt; Block -&gt; Statement_
</span><a href="AST.html#ForStmt"><span class="hs-identifier hs-var">ForStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assignment -&gt; Maybe Assignment
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204795"><span class="hs-identifier hs-var">init</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204797"><span class="hs-identifier hs-var">predExpr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Assignment -&gt; Maybe Assignment
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Assignment
</span><a href="#local-6989586621679204800"><span class="hs-identifier hs-var">update</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204796"><span class="hs-identifier hs-var">block'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204799"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-785"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#WhileStatement"><span class="hs-identifier hs-type">P.WhileStatement</span></a></span><span> </span><span id="local-6989586621679204803"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204803"><span class="hs-identifier hs-var">expr</span></a></span></span><span> </span><span id="local-6989586621679204804"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204804"><span class="hs-identifier hs-var">block</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-786"></span><span>  </span><span id="local-6989586621679204805"><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204805"><span class="hs-identifier hs-var">block'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">BlockType -&gt; Maybe MethodSig -&gt; Block -&gt; Semantic Block
</span><a href="Semantic.html#irgenBlock"><span class="hs-identifier hs-var">irgenBlock</span></a></span><span> </span><span class="annot"><span class="annottext">BlockType
</span><a href="Semantic.html#WhileBlock"><span class="hs-identifier hs-var">WhileBlock</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe MethodSig
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204804"><span class="hs-identifier hs-var">block</span></a></span><span>
</span><span id="line-787"></span><span>  </span><span id="local-6989586621679204806"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204806"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204807"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204807"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204803"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span id="local-6989586621679204808"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204808"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-789"></span><span>  </span><span class="hs-comment">-- Semantic[14]</span><span>
</span><span id="line-790"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204807"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name) -&gt; Type -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
</span><span class="hs-string">&quot;The pred of while statment must have type bool, but got &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Type -&gt; Name) (Type -&gt; Name)
-&gt; Format Name (Type -&gt; Name) -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
forall a r. Show a =&gt; Format r (a -&gt; r)
</span><span class="hs-identifier hs-var">shown</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Type -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Type -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; instead!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204807"><span class="hs-identifier hs-var">tpe</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-793"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Assignment -&gt; Expr -&gt; Maybe Assignment -&gt; Block -&gt; Statement_
</span><a href="AST.html#ForStmt"><span class="hs-identifier hs-var">ForStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Assignment
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204806"><span class="hs-identifier hs-var">expr'</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Assignment
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="annot"><span class="annottext">Block
</span><a href="#local-6989586621679204805"><span class="hs-identifier hs-var">block'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204808"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-794"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ReturnExprStatement"><span class="hs-identifier hs-type">P.ReturnExprStatement</span></a></span><span> </span><span id="local-6989586621679204810"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204810"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-795"></span><span>  </span><span id="local-6989586621679204811"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204811"><span class="hs-identifier hs-var">expr'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204810"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-796"></span><span>  </span><span id="local-6989586621679204812"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204812"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-comment">-- Semantic[8] and Semantic[9]</span><span>
</span><span id="line-798"></span><span>  </span><span class="annot"><span class="annottext">Maybe Expr -&gt; Semantic ()
</span><a href="Semantic.html#checkReturnType"><span class="hs-identifier hs-var">checkReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Expr -&gt; Semantic ()) -&gt; Maybe Expr -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204811"><span class="hs-identifier hs-var">expr'</span></a></span><span>
</span><span id="line-799"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expr -&gt; Statement_
</span><a href="AST.html#ReturnStmt"><span class="hs-identifier hs-var">ReturnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Expr -&gt; Statement_) -&gt; Maybe Expr -&gt; Statement_
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Maybe Expr
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204811"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204812"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-800"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="Parser.Tree.html#ReturnVoidStatement"><span class="hs-identifier hs-var">P.ReturnVoidStatement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-801"></span><span>  </span><span id="local-6989586621679204815"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204815"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-comment">-- Semantic[8] and Semantic[9]</span><span>
</span><span id="line-803"></span><span>  </span><span class="annot"><span class="annottext">Maybe Expr -&gt; Semantic ()
</span><a href="Semantic.html#checkReturnType"><span class="hs-identifier hs-var">checkReturnType</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-804"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe Expr -&gt; Statement_
</span><a href="AST.html#ReturnStmt"><span class="hs-identifier hs-var">ReturnStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Expr
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204815"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-805"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="Parser.Tree.html#BreakStatement"><span class="hs-identifier hs-var">P.BreakStatement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-806"></span><span>  </span><span id="local-6989586621679204817"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204817"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span class="hs-comment">-- Semantic[21]</span><span>
</span><span id="line-808"></span><span>  </span><span id="local-6989586621679204818"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204818"><span class="hs-identifier hs-var">inLoop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Bool
</span><a href="Semantic.html#isInsideLoop"><span class="hs-identifier hs-var">isInsideLoop</span></a></span><span>
</span><span id="line-809"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204818"><span class="hs-identifier hs-var">inLoop</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Found break statement outside for or while block!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-812"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="annot"><span class="annottext">Statement_
</span><a href="AST.html#BreakStmt"><span class="hs-identifier hs-var">BreakStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204817"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-813"></span><span class="annot"><a href="Semantic.html#irgenStmt"><span class="hs-identifier hs-var">irgenStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Statement
</span><a href="Parser.Tree.html#ContinueStatement"><span class="hs-identifier hs-var">P.ContinueStatement</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-814"></span><span>  </span><span id="local-6989586621679204821"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204821"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Range
</span><a href="Semantic.html#getCurrentRange"><span class="hs-identifier hs-var">getCurrentRange</span></a></span><span>
</span><span id="line-815"></span><span>  </span><span class="hs-comment">-- Semantic[21]</span><span>
</span><span id="line-816"></span><span>  </span><span id="local-6989586621679204822"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204822"><span class="hs-identifier hs-var">inLoop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Semantic Bool
</span><a href="Semantic.html#isInsideLoop"><span class="hs-identifier hs-var">isInsideLoop</span></a></span><span>
</span><span id="line-817"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">unless</span></span><span>
</span><span id="line-818"></span><span>    </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204822"><span class="hs-identifier hs-var">inLoop</span></a></span><span>
</span><span id="line-819"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Found continue statement outside for or while block!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><span class="annottext">Statement -&gt; Semantic Statement
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Statement -&gt; Semantic Statement)
-&gt; Statement -&gt; Semantic Statement
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Statement_ -&gt; Range -&gt; Statement
</span><a href="AST.html#Statement"><span class="hs-identifier hs-var">Statement</span></a></span><span> </span><span class="annot"><span class="annottext">Statement_
</span><a href="AST.html#ContinueStmt"><span class="hs-identifier hs-var">ContinueStmt</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204821"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">{- generate expressions, also do type inference -}</span><span>
</span><span id="line-823"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-type">irgenExpr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#Expr"><span class="hs-identifier hs-type">P.Expr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-824"></span><span id="irgenExpr"><span class="annot"><span class="annottext">irgenExpr :: Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var hs-var">irgenExpr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204824"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204824"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#LocationExpr"><span class="hs-identifier hs-type">P.LocationExpr</span></a></span><span> </span><span id="local-6989586621679204826"><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204826"><span class="hs-identifier hs-var">loc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-825"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204824"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-826"></span><span>  </span><span id="local-6989586621679204827"><span class="annot"><span class="annottext">loc' :: Location
</span><a href="#local-6989586621679204827"><span class="hs-identifier hs-var">loc'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Location"><span class="hs-identifier hs-type">Location</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Location :: Location -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3ALocation"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204828"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204828"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Location -&gt; Semantic Location
</span><a href="Semantic.html#irgenLocation"><span class="hs-identifier hs-var">irgenLocation</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204826"><span class="hs-identifier hs-var">loc</span></a></span><span>
</span><span id="line-827"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Location -&gt; Expr_
</span><a href="AST.html#LocationExpr"><span class="hs-identifier hs-var">LocationExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Location
</span><a href="#local-6989586621679204827"><span class="hs-identifier hs-var">loc'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204828"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204824"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-828"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204830"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204830"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#MethodCallExpr"><span class="hs-identifier hs-type">P.MethodCallExpr</span></a></span><span> </span><span id="local-6989586621679204832"><span class="annot"><span class="annottext">method :: MethodCall
</span><a href="#local-6989586621679204832"><span class="hs-identifier hs-var">method</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#MethodCall"><span class="hs-identifier hs-type">P.MethodCall</span></a></span><span> </span><span id="local-6989586621679204833"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204833"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Located ImportArg]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-829"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204830"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-830"></span><span>  </span><span id="local-6989586621679204834"><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204834"><span class="hs-identifier hs-var">method'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MethodCall -&gt; Semantic MethodCall
</span><a href="Semantic.html#irgenMethod"><span class="hs-identifier hs-var">irgenMethod</span></a></span><span> </span><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204832"><span class="hs-identifier hs-var">method</span></a></span><span>
</span><span id="line-831"></span><span>  </span><span id="local-6989586621679204835"><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204835"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either ImportDecl MethodDecl)
</span><a href="Semantic.html#lookupMethod%27"><span class="hs-identifier hs-var">lookupMethod'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204833"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-832"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either ImportDecl MethodDecl
</span><a href="#local-6989586621679204835"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-833"></span><span>    </span><span class="hs-comment">-- treat import methods as always return int</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ImportDecl
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodCall -&gt; Expr_
</span><a href="AST.html#MethodCallExpr"><span class="hs-identifier hs-var">MethodCallExpr</span></a></span><span> </span><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204834"><span class="hs-identifier hs-var">method'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204830"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodDecl"><span class="hs-identifier hs-type">MethodDecl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#MethodSig"><span class="hs-identifier hs-type">MethodSig</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679204837"><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204837"><span class="hs-identifier hs-var">tpe</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Argument]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Block
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-836"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Type
</span><a href="#local-6989586621679204837"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-837"></span><span>        </span><span class="hs-comment">-- Semantic[6]</span><span>
</span><span id="line-838"></span><span>        </span><span class="annot"><span class="annottext">Maybe Type
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-839"></span><span>          </span><span class="annot"><span class="annottext">Name -&gt; Semantic Expr
forall a. Name -&gt; Semantic a
</span><a href="Semantic.html#throwSemanticException"><span class="hs-identifier hs-var">throwSemanticException</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic Expr) -&gt; Name -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-840"></span><span>            </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;Method &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot; cannot be used in expressions as it returns nothing!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204833"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-841"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679204838"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204838"><span class="hs-identifier hs-var">tpe'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MethodCall -&gt; Expr_
</span><a href="AST.html#MethodCallExpr"><span class="hs-identifier hs-var">MethodCallExpr</span></a></span><span> </span><span class="annot"><span class="annottext">MethodCall
</span><a href="#local-6989586621679204834"><span class="hs-identifier hs-var">method'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204838"><span class="hs-identifier hs-var">tpe'</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204830"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-842"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204839"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204839"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#IntLiteralExpr"><span class="hs-identifier hs-type">P.IntLiteralExpr</span></a></span><span> </span><span id="local-6989586621679204841"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204841"><span class="hs-identifier hs-var">i</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-843"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204839"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-844"></span><span>  </span><span id="local-6989586621679204842"><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204842"><span class="hs-identifier hs-var">literalVal</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic Int64
</span><a href="Semantic.html#checkInt64Literal"><span class="hs-identifier hs-var">checkInt64Literal</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204841"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-845"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64 -&gt; Expr_
</span><a href="AST.html#IntLiteralExpr"><span class="hs-identifier hs-var">IntLiteralExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679204842"><span class="hs-identifier hs-var">literalVal</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204839"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-846"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204844"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204844"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#BoolLiteralExpr"><span class="hs-identifier hs-type">P.BoolLiteralExpr</span></a></span><span> </span><span id="local-6989586621679204846"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204846"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-847"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204844"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-848"></span><span>  </span><span id="local-6989586621679204847"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204847"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic Bool
</span><a href="Semantic.html#checkBoolLiteral"><span class="hs-identifier hs-var">checkBoolLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204846"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-849"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Expr_
</span><a href="AST.html#BoolLiteralExpr"><span class="hs-identifier hs-var">BoolLiteralExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679204847"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204844"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-850"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204849"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204849"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#CharLiteralExpr"><span class="hs-identifier hs-type">P.CharLiteralExpr</span></a></span><span> </span><span id="local-6989586621679204851"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204851"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-851"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204849"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-852"></span><span>  </span><span id="local-6989586621679204852"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679204852"><span class="hs-identifier hs-var">lit</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic Char
</span><a href="Semantic.html#checkCharLiteral"><span class="hs-identifier hs-var">checkCharLiteral</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204851"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-853"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Expr_
</span><a href="AST.html#CharLiteralExpr"><span class="hs-identifier hs-var">CharLiteralExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679204852"><span class="hs-identifier hs-var">lit</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204849"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-854"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204854"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204854"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#LenExpr"><span class="hs-identifier hs-type">P.LenExpr</span></a></span><span> </span><span id="local-6989586621679204856"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204856"><span class="hs-identifier hs-var">id</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-855"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204854"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-856"></span><span>  </span><span id="local-6989586621679204857"><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204857"><span class="hs-identifier hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic (Either Argument FieldDecl)
</span><a href="Semantic.html#lookupVariable%27"><span class="hs-identifier hs-var">lookupVariable'</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204856"><span class="hs-identifier hs-var">id</span></a></span><span>
</span><span id="line-857"></span><span>  </span><span class="hs-comment">-- Semantic[13]</span><span>
</span><span id="line-858"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Argument FieldDecl
</span><a href="#local-6989586621679204857"><span class="hs-identifier hs-var">def</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-859"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#Argument"><span class="hs-identifier hs-type">Argument</span></a></span><span> </span><span id="local-6989586621679204858"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204858"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;len cannot operate on argument &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204858"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-860"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span id="local-6989586621679204859"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204859"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#ArrayType"><span class="hs-identifier hs-type">ArrayType</span></a></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Semantic ()
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="AST.html#FieldDecl"><span class="hs-identifier hs-type">FieldDecl</span></a></span><span> </span><span id="local-6989586621679204860"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204860"><span class="hs-identifier hs-var">nm</span></a></span></span><span> </span><span class="annot"><span class="annottext">Type
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Range
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">(Name -&gt; Semantic ()) -&gt; Name -&gt; Semantic ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name) -&gt; Name -&gt; Name
forall a. Format Name a -&gt; a
</span><span class="hs-identifier hs-var">sformat</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
</span><span class="hs-string">&quot;len cannot operate on scalar variable &quot;</span></span><span> </span><span class="annot"><span class="annottext">Format (Name -&gt; Name) (Name -&gt; Name)
-&gt; Format Name (Name -&gt; Name) -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
forall r. Format r (Name -&gt; r)
</span><span class="hs-identifier hs-var">stext</span></span><span> </span><span class="annot"><span class="annottext">Format Name (Name -&gt; Name)
-&gt; Format Name Name -&gt; Format Name (Name -&gt; Name)
forall r a r'. Format r a -&gt; Format r' r -&gt; Format r' a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Format Name Name
</span><span class="hs-string">&quot;!&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204860"><span class="hs-identifier hs-var">nm</span></a></span><span>
</span><span id="line-862"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Expr_
</span><a href="AST.html#LengthExpr"><span class="hs-identifier hs-var">LengthExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204856"><span class="hs-identifier hs-var">id</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204854"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-863"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204862"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204862"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ArithOpExpr"><span class="hs-identifier hs-type">P.ArithOpExpr</span></a></span><span> </span><span id="local-6989586621679204864"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204864"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679204865"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204865"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679204866"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204866"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-864"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204862"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-865"></span><span>  </span><span class="hs-comment">-- Semantic[16]</span><span>
</span><span id="line-866"></span><span>  </span><span id="local-6989586621679204867"><span class="annot"><span class="annottext">l' :: Expr
</span><a href="#local-6989586621679204867"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204868"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204868"><span class="hs-identifier hs-var">ltp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204865"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-867"></span><span>  </span><span id="local-6989586621679204869"><span class="annot"><span class="annottext">r' :: Expr
</span><a href="#local-6989586621679204869"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204870"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204870"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204866"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-868"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-869"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204868"><span class="hs-identifier hs-var">ltp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204870"><span class="hs-identifier hs-var">rtp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;There can only be integer values in arithmetic expressions.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ArithOp -&gt; Expr -&gt; Expr -&gt; Expr_
</span><a href="AST.html#ArithOpExpr"><span class="hs-identifier hs-var">ArithOpExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; ArithOp
</span><a href="AST.html#parseArithOp"><span class="hs-identifier hs-var">parseArithOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204864"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204867"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204869"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204862"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-872"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204873"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204873"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#RelOpExpr"><span class="hs-identifier hs-type">P.RelOpExpr</span></a></span><span> </span><span id="local-6989586621679204875"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204875"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679204876"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204876"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679204877"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204877"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-873"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204873"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-874"></span><span>  </span><span class="hs-comment">-- Semantic[16]</span><span>
</span><span id="line-875"></span><span>  </span><span id="local-6989586621679204878"><span class="annot"><span class="annottext">l' :: Expr
</span><a href="#local-6989586621679204878"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204879"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204879"><span class="hs-identifier hs-var">ltp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204876"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-876"></span><span>  </span><span id="local-6989586621679204880"><span class="annot"><span class="annottext">r' :: Expr
</span><a href="#local-6989586621679204880"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204881"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204881"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204877"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-877"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-878"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204879"><span class="hs-identifier hs-var">ltp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204881"><span class="hs-identifier hs-var">rtp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-879"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;There can only be integer values in relational expressions.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">RelOp -&gt; Expr -&gt; Expr -&gt; Expr_
</span><a href="AST.html#RelOpExpr"><span class="hs-identifier hs-var">RelOpExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; RelOp
</span><a href="AST.html#parseRelOp"><span class="hs-identifier hs-var">parseRelOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204875"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204878"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204880"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204873"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-881"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204884"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204884"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#EqOpExpr"><span class="hs-identifier hs-type">P.EqOpExpr</span></a></span><span> </span><span id="local-6989586621679204886"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204886"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679204887"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204887"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679204888"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204888"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-882"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204884"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-883"></span><span>  </span><span class="hs-comment">-- Semantic[17]</span><span>
</span><span id="line-884"></span><span>  </span><span id="local-6989586621679204889"><span class="annot"><span class="annottext">l' :: Expr
</span><a href="#local-6989586621679204889"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204890"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204890"><span class="hs-identifier hs-var">ltp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204887"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-885"></span><span>  </span><span id="local-6989586621679204891"><span class="annot"><span class="annottext">r' :: Expr
</span><a href="#local-6989586621679204891"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204892"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204892"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204888"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-886"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-887"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204890"><span class="hs-identifier hs-var">ltp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204892"><span class="hs-identifier hs-var">rtp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; (Type, Type) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204890"><span class="hs-identifier hs-var">ltp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204892"><span class="hs-identifier hs-var">rtp</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Type, Type) -&gt; (Type, Type) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Can only check equality of expressions with the SAME type!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EqOp -&gt; Expr -&gt; Expr -&gt; Expr_
</span><a href="AST.html#EqOpExpr"><span class="hs-identifier hs-var">EqOpExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; EqOp
</span><a href="AST.html#parseEqOp"><span class="hs-identifier hs-var">parseEqOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204886"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204889"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204891"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204884"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-890"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204895"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204895"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#CondOpExpr"><span class="hs-identifier hs-type">P.CondOpExpr</span></a></span><span> </span><span id="local-6989586621679204897"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204897"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679204898"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204898"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679204899"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204899"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-891"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204895"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-892"></span><span>  </span><span class="hs-comment">-- Semantic[18]</span><span>
</span><span id="line-893"></span><span>  </span><span id="local-6989586621679204900"><span class="annot"><span class="annottext">l' :: Expr
</span><a href="#local-6989586621679204900"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204901"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204901"><span class="hs-identifier hs-var">ltp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204898"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-894"></span><span>  </span><span id="local-6989586621679204902"><span class="annot"><span class="annottext">r' :: Expr
</span><a href="#local-6989586621679204902"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204903"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204903"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204899"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-895"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-896"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204901"><span class="hs-identifier hs-var">ltp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204903"><span class="hs-identifier hs-var">rtp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Conditional ops only accept booleans!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CondOp -&gt; Expr -&gt; Expr -&gt; Expr_
</span><a href="AST.html#CondOpExpr"><span class="hs-identifier hs-var">CondOpExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; CondOp
</span><a href="AST.html#parseCondOp"><span class="hs-identifier hs-var">parseCondOp</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204897"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204900"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204902"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204895"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-899"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204906"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204906"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#NegativeExpr"><span class="hs-identifier hs-type">P.NegativeExpr</span></a></span><span> </span><span id="local-6989586621679204908"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204908"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-900"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204906"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-901"></span><span>  </span><span class="hs-comment">-- Semantic[16]</span><span>
</span><span id="line-902"></span><span>  </span><span id="local-6989586621679204909"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204909"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204910"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204910"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204908"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-903"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-904"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204910"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-905"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Operator \&quot;-\&quot; only accepts integers!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-906"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NegOp -&gt; Expr -&gt; Expr_
</span><a href="AST.html#NegOpExpr"><span class="hs-identifier hs-var">NegOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NegOp
</span><a href="AST.html#Neg"><span class="hs-identifier hs-var">Neg</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204909"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#IntType"><span class="hs-identifier hs-var">IntType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204906"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-907"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204913"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204913"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#NegateExpr"><span class="hs-identifier hs-type">P.NegateExpr</span></a></span><span> </span><span id="local-6989586621679204915"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204915"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-908"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204913"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-909"></span><span>  </span><span class="hs-comment">-- Semantic[18]</span><span>
</span><span id="line-910"></span><span>  </span><span id="local-6989586621679204916"><span class="annot"><span class="annottext">expr' :: Expr
</span><a href="#local-6989586621679204916"><span class="hs-identifier hs-var">expr'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204917"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204917"><span class="hs-identifier hs-var">tpe</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204915"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-911"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-912"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204917"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-913"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Operator \&quot;!\&quot; only accepts integers!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-914"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NotOp -&gt; Expr -&gt; Expr_
</span><a href="AST.html#NotOpExpr"><span class="hs-identifier hs-var">NotOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">NotOp
</span><a href="AST.html#Not"><span class="hs-identifier hs-var">Not</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204916"><span class="hs-identifier hs-var">expr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204913"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-915"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204920"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204920"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ChoiceExpr"><span class="hs-identifier hs-type">P.ChoiceExpr</span></a></span><span> </span><span id="local-6989586621679204922"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204922"><span class="hs-identifier hs-var">pred</span></a></span></span><span> </span><span id="local-6989586621679204923"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204923"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679204924"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204924"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-916"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204920"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-917"></span><span>  </span><span id="local-6989586621679204925"><span class="annot"><span class="annottext">pred' :: Expr
</span><a href="#local-6989586621679204925"><span class="hs-identifier hs-var">pred'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204926"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204926"><span class="hs-identifier hs-var">ptp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204922"><span class="hs-identifier hs-var">pred</span></a></span><span>
</span><span id="line-918"></span><span>  </span><span id="local-6989586621679204927"><span class="annot"><span class="annottext">l' :: Expr
</span><a href="#local-6989586621679204927"><span class="hs-identifier hs-var">l'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204928"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204928"><span class="hs-identifier hs-var">ltp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204923"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span id="local-6989586621679204929"><span class="annot"><span class="annottext">r' :: Expr
</span><a href="#local-6989586621679204929"><span class="hs-identifier hs-var">r'</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:tpe:Expr :: Expr -&gt; Type
</span><a href="AST.html#%24sel%3Atpe%3AExpr"><span class="hs-identifier hs-var">tpe</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679204930"><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204930"><span class="hs-identifier hs-var">rtp</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204924"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-920"></span><span>  </span><span class="hs-comment">-- Semantic[15]</span><span>
</span><span id="line-921"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-922"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204926"><span class="hs-identifier hs-var">ptp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#BoolType"><span class="hs-identifier hs-var">BoolType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-923"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Predicate of choice operator must be a boolean!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Semantic () -&gt; Semantic ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span>
</span><span id="line-925"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204928"><span class="hs-identifier hs-var">ltp</span></a></span><span> </span><span class="annot"><span class="annottext">Type -&gt; Type -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204930"><span class="hs-identifier hs-var">rtp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Semantic ()
</span><a href="Semantic.html#addSemanticError"><span class="hs-identifier hs-var">addSemanticError</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><span class="hs-string">&quot;Alternatives of choice op should have same type!&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-927"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ChoiceOp -&gt; Expr -&gt; Expr -&gt; Expr -&gt; Expr_
</span><a href="AST.html#ChoiceOpExpr"><span class="hs-identifier hs-var">ChoiceOpExpr</span></a></span><span> </span><span class="annot"><span class="annottext">ChoiceOp
</span><a href="AST.html#Choice"><span class="hs-identifier hs-var">Choice</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204925"><span class="hs-identifier hs-var">pred'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204927"><span class="hs-identifier hs-var">l'</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679204929"><span class="hs-identifier hs-var">r'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="#local-6989586621679204928"><span class="hs-identifier hs-var">ltp</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204920"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-928"></span><span class="annot"><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204933"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204933"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ParenExpr"><span class="hs-identifier hs-type">P.ParenExpr</span></a></span><span> </span><span id="local-6989586621679204935"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204935"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-929"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204933"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-930"></span><span>  </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204935"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-931"></span><span>
</span><span id="line-932"></span><span class="annot"><a href="Semantic.html#irgenImportArg"><span class="hs-identifier hs-type">irgenImportArg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Util.SourceLoc.html#Located"><span class="hs-identifier hs-type">SL.Located</span></a></span><span> </span><span class="annot"><a href="Parser.Tree.html#ImportArg"><span class="hs-identifier hs-type">P.ImportArg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Semantic.html#Semantic"><span class="hs-identifier hs-type">Semantic</span></a></span><span> </span><span class="annot"><a href="AST.html#Expr"><span class="hs-identifier hs-type">Expr</span></a></span><span>
</span><span id="line-933"></span><span id="irgenImportArg"><span class="annot"><span class="annottext">irgenImportArg :: Located ImportArg -&gt; Semantic Expr
</span><a href="Semantic.html#irgenImportArg"><span class="hs-identifier hs-var hs-var">irgenImportArg</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204936"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204936"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#ExprImportArg"><span class="hs-identifier hs-type">P.ExprImportArg</span></a></span><span> </span><span id="local-6989586621679204938"><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204938"><span class="hs-identifier hs-var">expr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Located Expr -&gt; Semantic Expr
</span><a href="Semantic.html#irgenExpr"><span class="hs-identifier hs-var">irgenExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Located Expr
</span><a href="#local-6989586621679204938"><span class="hs-identifier hs-var">expr</span></a></span><span>
</span><span id="line-934"></span><span class="annot"><a href="Semantic.html#irgenImportArg"><span class="hs-identifier hs-var">irgenImportArg</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Util.SourceLoc.html#LocatedAt"><span class="hs-identifier hs-type">SL.LocatedAt</span></a></span><span> </span><span id="local-6989586621679204939"><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204939"><span class="hs-identifier hs-var">range</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Parser.Tree.html#StringImportArg"><span class="hs-identifier hs-type">P.StringImportArg</span></a></span><span> </span><span id="local-6989586621679204941"><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204941"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-935"></span><span>  </span><span class="annot"><span class="annottext">Range -&gt; Semantic ()
</span><a href="Semantic.html#updateCurrentRange"><span class="hs-identifier hs-var">updateCurrentRange</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204939"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-936"></span><span>  </span><span class="annot"><span class="annottext">Expr -&gt; Semantic Expr
forall a. a -&gt; Semantic a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">(Expr -&gt; Semantic Expr) -&gt; Expr -&gt; Semantic Expr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Expr_ -&gt; Type -&gt; Range -&gt; Expr
</span><a href="AST.html#Expr"><span class="hs-identifier hs-var">Expr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Name -&gt; Expr_
</span><a href="AST.html#StringLiteralExpr"><span class="hs-identifier hs-var">StringLiteralExpr</span></a></span><span> </span><span class="annot"><span class="annottext">Name
</span><a href="#local-6989586621679204941"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Type
</span><a href="AST.html#StringType"><span class="hs-identifier hs-var">StringType</span></a></span><span> </span><span class="annot"><span class="annottext">Range
</span><a href="#local-6989586621679204939"><span class="hs-identifier hs-var">range</span></a></span><span>
</span><span id="line-937"></span></pre></body></html>